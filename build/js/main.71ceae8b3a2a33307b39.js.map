{"version":3,"file":"js/main.71ceae8b3a2a33307b39.js","mappings":"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","sources":["webpack://wind-station-app/webpack/runtime/chunk loaded","webpack://wind-station-app/./src/public/assets/js/L.Control.Layers.Tree.js","webpack://wind-station-app/./src/components/InfoControl.js","webpack://wind-station-app/./src/components/airspaces.js","webpack://wind-station-app/./src/components/airspacesGliding.js","webpack://wind-station-app/./src/components/airspacesNotam.js","webpack://wind-station-app/./src/components/airspacesXC.js","webpack://wind-station-app/./src/components/windstations.js","webpack://wind-station-app/./src/components/spotsHelper.js","webpack://wind-station-app/./src/components/spotsPG.js","webpack://wind-station-app/./src/components/spotsHG.js","webpack://wind-station-app/./src/components/spotsLZ.js","webpack://wind-station-app/./src/public/assets/js/index.js","webpack://wind-station-app/./node_modules/moment/locale/ sync ^\\.\\/.*$","webpack://wind-station-app/webpack/bootstrap","webpack://wind-station-app/webpack/runtime/hasOwnProperty shorthand","webpack://wind-station-app/webpack/runtime/node module decorator","webpack://wind-station-app/webpack/runtime/jsonp chunk loading","webpack://wind-station-app/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","/*\n * Control like L.Control.Layers, but showing layers in a tree.\n * Do not forget to include the css file.\n */\nconsole.log(\"L.Control.Layers.Tree has been loaded!\");\n(function(L) {\n    if (typeof L === 'undefined') {\n        throw new Error('Leaflet must be included first');\n    }\n\n    /*\n     * L.Control.Layers.Tree extends L.Control.Layers because it reuses\n     * most of its functionality. Only the HTML creation is different.\n     */\n    L.Control.Layers.Tree = L.Control.Layers.extend({\n        options: {\n            closedSymbol: '+',\n            openedSymbol: '&minus;',\n            spaceSymbol: ' ',\n            selectorBack: false,\n            namedToggle: false,\n            collapseAll: '',\n            expandAll: '',\n            labelIsSelector: 'both',\n        },\n\n        // Class names are error prone texts, so write them once here\n        _initClassesNames: function() {\n            this.cls = {\n                children: 'leaflet-layerstree-children',\n                childrenNopad: 'leaflet-layerstree-children-nopad',\n                hide: 'leaflet-layerstree-hide',\n                closed: 'leaflet-layerstree-closed',\n                opened: 'leaflet-layerstree-opened',\n                space: 'leaflet-layerstree-header-space',\n                pointer: 'leaflet-layerstree-header-pointer',\n                header: 'leaflet-layerstree-header',\n                neverShow: 'leaflet-layerstree-nevershow',\n                node: 'leaflet-layerstree-node',\n                name: 'leaflet-layerstree-header-name',\n                label: 'leaflet-layerstree-header-label',\n                selAllCheckbox: 'leaflet-layerstree-sel-all-checkbox',\n            };\n        },\n\n        initialize: function(baseTree, overlaysTree, options) {\n            this._scrollTop = 0;\n            this._initClassesNames();\n            this._baseTree = null;\n            this._overlaysTree = null;\n            L.Util.setOptions(this, options);\n            L.Control.Layers.prototype.initialize.call(this, null, null, options);\n            this._setTrees(baseTree, overlaysTree);\n        },\n\n        setBaseTree: function(tree) {\n            return this._setTrees(tree);\n        },\n\n        setOverlayTree: function(tree) {\n            return this._setTrees(undefined, tree);\n        },\n\n        addBaseLayer: function(_layer, _name) {\n            throw 'addBaseLayer is disabled';\n        },\n\n        addOverlay: function(_layer, _name) {\n            throw 'addOverlay is disabled';\n        },\n\n        removeLayer: function(_layer) {\n            throw 'removeLayer is disabled';\n        },\n\n        collapse: function() {\n            this._scrollTop = this._sect().scrollTop;\n            return L.Control.Layers.prototype.collapse.call(this);\n        },\n\n        expand: function() {\n            L.Control.Layers.prototype.expand.call(this);\n            this._sect().scrollTop = this._scrollTop;\n        },\n\n        onAdd: function(map) {\n            function changeName(layer) {\n                if (layer._layersTreeName) {\n                    toggle.innerHTML = layer._layersTreeName;\n                }\n            }\n\n            var ret = L.Control.Layers.prototype.onAdd.call(this, map);\n            if (this.options.namedToggle) {\n                var toggle = this._container.getElementsByClassName('leaflet-control-layers-toggle')[0];\n                L.DomUtil.addClass(toggle, 'leaflet-layerstree-named-toggle');\n                // Start with this value...\n                map.eachLayer(function(layer) {changeName(layer);});\n                // ... and change it whenever the baselayer is changed.\n                map.on('baselayerchange', function(e) {changeName(e.layer);}, this);\n            }\n            return ret;\n        },\n\n        // Expands the whole tree (base other overlays)\n        expandTree: function(overlay) {\n            var container = overlay ? this._overlaysList : this._baseLayersList;\n            if (container) {\n                this._applyOnTree(container, false);\n            }\n            return this._localExpand();\n        },\n\n        // Collapses the whole tree (base other overlays)\n        collapseTree: function(overlay) {\n            var container = overlay ? this._overlaysList : this._baseLayersList;\n            if (container) {\n                this._applyOnTree(container, true);\n            }\n            return this._localExpand();\n        },\n\n        // Expands the tree, only to show the selected inputs\n        expandSelected: function(overlay) {\n            function iter(el) {\n                // Function to iterate the whole DOM upwards\n                var p = el.parentElement;\n                if (p) {\n                    if (L.DomUtil.hasClass(p, that.cls.children) &&\n                        !L.DomUtil.hasClass(el, that.cls.childrenNopad)) {\n                        L.DomUtil.removeClass(p, hide);\n                    }\n\n                    if (L.DomUtil.hasClass(p, that.cls.node)) {\n                        var h = p.getElementsByClassName(that.cls.header)[0];\n                        that._applyOnTree(h, false);\n                    }\n                    iter(p);\n                }\n            }\n\n            var that = this;\n            var container = overlay ? this._overlaysList : this._baseLayersList;\n            if (!container) return this;\n            var hide = this.cls.hide;\n            var inputs = this._layerControlInputs || container.getElementsByTagName('input');\n            for (var i = 0; i < inputs.length; i++) {\n                // Loop over every (valid) input.\n                var input = inputs[i];\n                if (this._getLayer && !!this._getLayer(input.layerId).overlay != !!overlay) continue;\n                if (input.checked) {\n                    // Get out of the header,\n                    // to not open the possible (but rare) children\n                    iter(input.parentElement.parentElement.parentElement.parentElement);\n                }\n            }\n            return this._localExpand();\n        },\n\n        // \"private\" methods, not exposed in the API\n        _sect: function() {\n            // to keep compatibility after 1.3 https://github.com/Leaflet/Leaflet/pull/6380\n            return this._section || this._form;\n        },\n\n        _setTrees: function(base, overlays) {\n            var id = 0; // to keep unique id\n            function iterate(tree, output, overlays) {\n                if (tree && tree.layer) {\n                    if (!overlays) {\n                        tree.layer._layersTreeName = tree.name || tree.label;\n                    }\n                    output[id++] = tree.layer;\n                }\n                if (tree && tree.children && tree.children.length) {\n                    tree.children.forEach(function(child) {\n                        iterate(child, output, overlays);\n                    });\n                }\n                return output;\n            }\n\n            // We accept arrays, but convert into an object with children\n            function forArrays(input) {\n                if (Array.isArray(input)) {\n                    return {noShow: true, children: input};\n                } else {\n                    return input;\n                }\n            }\n\n            // Clean everything, and start again.\n            if (this._layerControlInputs) {\n                this._layerControlInputs = [];\n            }\n            for (var i = 0; i < this._layers.length; ++i) {\n                this._layers[i].layer.off('add remove', this._onLayerChange, this);\n            }\n            this._layers = [];\n\n            if (base !== undefined) this._baseTree = forArrays(base);\n            if (overlays !== undefined) this._overlaysTree = forArrays(overlays);\n\n            var bflat = iterate(this._baseTree, {});\n            for (var j in bflat) {\n                this._addLayer(bflat[j], j);\n            }\n\n            var oflat = iterate(this._overlaysTree, {}, true);\n            for (var k in oflat) {\n                this._addLayer(oflat[k], k, true);\n            }\n            return (this._map) ? this._update() : this;\n        },\n\n        // Used to update the vertical scrollbar\n        _localExpand: function() {\n            if (this._map && L.DomUtil.hasClass(this._container, 'leaflet-control-layers-expanded')) {\n                var top = this._sect().scrollTop;\n                this.expand();\n                this._sect().scrollTop = top; // to keep the scroll location\n                this._scrollTop = top;\n            }\n            return this;\n        },\n\n        // collapses or expands the tree in the container.\n        _applyOnTree: function(container, collapse) {\n            var iters = [\n                {cls: this.cls.children, hide: collapse},\n                {cls: this.cls.opened, hide: collapse},\n                {cls: this.cls.closed, hide: !collapse},\n            ];\n            iters.forEach(function(it) {\n                var els = container.getElementsByClassName(it.cls);\n                for (var i = 0; i < els.length; i++) {\n                    var el = els[i];\n                    if (L.DomUtil.hasClass(el, this.cls.childrenNopad)) {\n                        // do nothing\n                    } else if (it.hide) {\n                        L.DomUtil.addClass(el, this.cls.hide);\n                    } else {\n                        L.DomUtil.removeClass(el, this.cls.hide);\n                    }\n                }\n            }, this);\n        },\n\n        // it is called in the original _update, and shouldn't do anything.\n        _addItem: function(_obj) {\n        },\n\n        // overwrite _update function in Control.Layers\n        _update: function() {\n            if (!this._container) { return this; }\n            L.Control.Layers.prototype._update.call(this);\n            this._addTreeLayout(this._baseTree, false);\n            this._addTreeLayout(this._overlaysTree, true);\n            return this._localExpand();\n        },\n\n        // Create the DOM objects for the tree\n        _addTreeLayout: function(tree, overlay) {\n            if (!tree) return;\n            var container = overlay ? this._overlaysList : this._baseLayersList;\n            this._expandCollapseAll(overlay, this.options.collapseAll, this.collapseTree);\n            this._expandCollapseAll(overlay, this.options.expandAll, this.expandTree);\n            this._iterateTreeLayout(tree, container, overlay, [], tree.noShow);\n            if (this._checkDisabledLayers) {\n                // to keep compatibility\n                this._checkDisabledLayers();\n            }\n        },\n\n        // Create the \"Collapse all\" or expand, if needed.\n        _expandCollapseAll: function(overlay, text, fn, ctx) {\n            var container = overlay ? this._overlaysList : this._baseLayersList;\n            ctx = ctx ? ctx : this;\n            if (text) {\n                var o = document.createElement('div');\n                o.className = 'leaflet-layerstree-expand-collapse';\n                container.appendChild(o);\n                o.innerHTML = text;\n                o.tabIndex = 0;\n                L.DomEvent.on(o, 'click keydown', function(e) {\n                    if (e.type !== 'keydown' || e.keyCode === 32) {\n                        o.blur();\n                        fn.call(ctx, overlay);\n                        this._localExpand();\n                    }\n                }, this);\n            }\n        },\n\n        // recursive function to create the DOM children\n        _iterateTreeLayout: function(tree, container, overlay, selAllNodes, noShow) {\n            if (!tree) return;\n            function creator(type, cls, append, innerHTML) {\n                var obj = L.DomUtil.create(type, cls, append);\n                if (innerHTML) obj.innerHTML = innerHTML;\n                return obj;\n            }\n\n            // Add this block to handle HTML elements\n            if (tree.html) {\n                var htmlContainer = creator('div', 'leaflet-layerstree-html-container', container);\n                htmlContainer.innerHTML = tree.html;\n                return;  // Skip normal processing for HTML nodes\n            }\n\n            // create the header with it fields\n            var header = creator('div', this.cls.header, container);\n            var sel = creator('span');\n            var entry = creator('span');\n            var closed = creator('span', this.cls.closed, sel, this.options.closedSymbol);\n            var opened = creator('span', this.cls.opened, sel, this.options.openedSymbol);\n            var space = creator('span', this.cls.space, null, this.options.spaceSymbol);\n            if (this.options.selectorBack) {\n                sel.insertBefore(space, closed);\n                header.appendChild(entry);\n                header.appendChild(sel);\n            } else {\n                sel.appendChild(space);\n                header.appendChild(sel);\n                header.appendChild(entry);\n            }\n\n            function updateSelAllCheckbox(ancestor) {\n                var selector = ancestor.querySelector('input[type=checkbox]');\n                var selectedAll = true;\n                var selectedNone = true;\n                var inputs = ancestor.querySelectorAll('input[type=checkbox]');\n                [].forEach.call(inputs, function(inp) { // to work in node for tests\n                    if (inp === selector) {\n                        // ignore\n                    } else if (inp.indeterminate) {\n                        selectedAll = false;\n                        selectedNone = false;\n                    } else if (inp.checked) {\n                        selectedNone = false;\n                    } else if (!inp.checked) {\n                        selectedAll = false;\n                    }\n                });\n                if (selectedAll) {\n                    selector.indeterminate = false;\n                    selector.checked = true;\n                } else if (selectedNone) {\n                    selector.indeterminate = false;\n                    selector.checked = false;\n                } else {\n                    selector.indeterminate = true;\n                    selector.checked = false;\n                }\n            }\n\n            function manageSelectorsAll(input, ctx) {\n                selAllNodes.forEach(function(ancestor) {\n                    L.DomEvent.on(input, 'click', function(_ev) {\n                        updateSelAllCheckbox(ancestor);\n                    }, ctx);\n                }, ctx);\n            }\n\n            var selAll;\n            if (tree.selectAllCheckbox) {\n                selAll = this._createCheckboxElement(false);\n                selAll.className += ' ' + this.cls.selAllCheckbox;\n            }\n\n            var hide = this.cls.hide; // To toggle state\n            // create the children group, with the header event click\n            if (tree.children) {\n                var children = creator('div', this.cls.children, container);\n                var sensible = tree.layer ? sel : header;\n                L.DomUtil.addClass(sensible, this.cls.pointer);\n                sensible.tabIndex = 0;\n                L.DomEvent.on(sensible, 'click keydown', function(e) {\n                    // leaflet internal flag to prevent click propagation and collapsing tree on mobile browsers\n                    if (this._preventClick) {\n                        return;\n                    }\n                    if (e.type === 'keydown' && e.keyCode !== 32) {\n                        return;\n                    }\n                    sensible.blur();\n\n                    if (L.DomUtil.hasClass(opened, hide)) {\n                        // it is not opened, so open it\n                        L.DomUtil.addClass(closed, hide);\n                        L.DomUtil.removeClass(opened, hide);\n                        L.DomUtil.removeClass(children, hide);\n                    } else {\n                        // close it\n                        L.DomUtil.removeClass(closed, hide);\n                        L.DomUtil.addClass(opened, hide);\n                        L.DomUtil.addClass(children, hide);\n                    }\n                    this._localExpand();\n                }, this);\n                if (selAll) {\n                    selAllNodes.splice(0, 0, container);\n                }\n                tree.children.forEach(function(child) {\n                    var node = creator('div', this.cls.node, children);\n                    this._iterateTreeLayout(child, node, overlay, selAllNodes);\n                }, this);\n                if (selAll) {\n                    selAllNodes.splice(0, 1);\n                }\n            } else {\n                // no children, so the selector makes no sense.\n                L.DomUtil.addClass(sel, this.cls.neverShow);\n            }\n\n            // make (or not) the label clickable to toggle the layer\n            var labelType;\n            if (tree.layer) {\n                if ((this.options.labelIsSelector === 'both') || // if option is set to both\n                    (overlay && this.options.labelIsSelector === 'overlay') || // if an overlay layer and options is set to overlay\n                    (!overlay && this.options.labelIsSelector === 'base')) { // if a base layer and option is set to base\n                    labelType = 'label';\n                } else { // if option is set to something else\n                    labelType = 'span';\n                }\n            } else {\n                labelType = 'span';\n            }\n            // create the input and label\n            var label = creator(labelType, this.cls.label, entry);\n            if (tree.layer) {\n                // now create the element like in _addItem\n                var checked = this._map.hasLayer(tree.layer);\n                var input;\n                var radioGroup = overlay ? tree.radioGroup : 'leaflet-base-layers_' + L.Util.stamp(this);\n                if (radioGroup) {\n                    input = this._createRadioElement(radioGroup, checked);\n                } else {\n                    input = this._createCheckboxElement(checked);\n                    manageSelectorsAll(input, this);\n                }\n                if (this._layerControlInputs) {\n                    // to keep compatibility with 1.0.3\n                    this._layerControlInputs.push(input);\n                }\n                input.layerId = L.Util.stamp(tree.layer);\n                L.DomEvent.on(input, 'click', this._onInputClick, this);\n                label.appendChild(input);\n            }\n\n            function isText(variable) {\n                return (typeof variable === 'string' || variable instanceof String);\n            }\n\n            function isFunction(functionToCheck) {\n                return functionToCheck && {}.toString.call(functionToCheck) === '[object Function]';\n            }\n\n            function selectAllCheckboxes(select, ctx) {\n                var inputs = container.getElementsByTagName('input');\n                for (var i = 0; i < inputs.length; i++) {\n                    var input = inputs[i];\n                    if (input.type !== 'checkbox') continue;\n                    input.checked = select;\n                    input.indeterminate = false;\n                }\n                ctx._onInputClick();\n            }\n            if (tree.selectAllCheckbox) {\n                // selAll is already created\n                label.appendChild(selAll);\n                if (isText(tree.selectAllCheckbox)) {\n                    selAll.title = tree.selectAllCheckbox;\n                }\n                L.DomEvent.on(selAll, 'click', function(ev) {\n                    ev.stopPropagation();\n                    selectAllCheckboxes(selAll.checked, this);\n                }, this);\n                updateSelAllCheckbox(container);\n                manageSelectorsAll(selAll, this);\n            }\n\n            creator('span', this.cls.name, label, tree.label);\n\n            // hide the button which doesn't fit the collapsed state, then hide children conditionally\n            L.DomUtil.addClass(tree.collapsed ? opened : closed, hide);\n            tree.collapsed && children && L.DomUtil.addClass(children, hide);\n\n            if (noShow) {\n                L.DomUtil.addClass(header, this.cls.neverShow);\n                L.DomUtil.addClass(children, this.cls.childrenNopad);\n            }\n\n            var eventeds = tree.eventedClasses;\n            if (!(eventeds instanceof Array)) {\n                eventeds = [eventeds];\n            }\n\n            for (var e = 0; e < eventeds.length; e++) {\n                var evented = eventeds[e];\n                if (evented && evented.className) {\n                    var obj = container.querySelector('.' + evented.className);\n                    if (obj) {\n                        L.DomEvent.on(obj, evented.event || 'click', (function(selectAll) {\n                            return function(ev) {\n                                ev.stopPropagation();\n                                var select = isFunction(selectAll) ? selectAll(ev, container, tree, this._map) : selectAll;\n                                if (select !== undefined && select !== null) {\n                                    selectAllCheckboxes(select, this);\n                                }\n                            };\n                        })(evented.selectAll), this);\n                    }\n                }\n            }\n        },\n\n        _createCheckboxElement: function(checked) {\n            var input = document.createElement('input');\n            input.type = 'checkbox';\n            input.className = 'leaflet-control-layers-selector';\n            input.defaultChecked = checked;\n            return input;\n        },\n\n    });\n\n    L.control.layers.tree = function(base, overlays, options) {\n        return new L.Control.Layers.Tree(base, overlays, options);\n    };\n \n})(L);\nconsole.log(\"L.Control.Layers.Tree has been loaded!\");\n","const L = window.L;\r\n\r\nconst InfoControl = L.Control.extend({\r\n    onAdd: function(map) {\r\n        var container = L.DomUtil.create('div', 'info-control leaflet-bar leaflet-control');\r\n        var link = L.DomUtil.create('a', 'leaflet-control-button', container);\r\n        link.href = '#';\r\n        var img = L.DomUtil.create('img', 'info-control-icon', link);\r\n        img.src = 'assets/images/info.png';\r\n        img.alt = 'Information';\r\n        img.style.width = '24px';\r\n        img.style.height = '24px';\r\n        img.style.padding = '4px';\r\n\r\n        L.DomEvent.disableClickPropagation(container);\r\n        L.DomEvent.on(link, 'click', function(e) {\r\n            L.DomEvent.stop(e);\r\n            var popupContent = '<div style=\"padding: 10px; max-width: 800px;\"><h3><img src=\"/assets/images/XCmapsLogo.png\" alt=\"XCmaps\"></h3>' +\r\n                '<p>You can contact us by email, or report any issue on github.</p>'+\r\n                '<p><strong>Credits:</strong></p>' +\r\n                '<ul>' +\r\n                '<li>Terrain tiles by <a href=\"https://www.jawg.io\" target=\"_blank\">Jawg</a></li>' +\r\n                '<li>OpenStreetMap</li>' +\r\n                '<li>XContest terrain data</li>' +\r\n                '<li>MapTiler for GL layer</li>' +\r\n                '<li>Airspaces: Airspaces are imported from openaip:\"OpenAIP data is not certified and must not be used for primary navigation or flight planning. Never rely on openAIP data! OpenAIP data contains errors. Using openAIP data may result in serious injury or death.\"</li>' +\r\n                '<li>Wind Stations: based on <a href=\"https://github.com/winds-mobi/\" target=\"_blank\">winds.mobi</a> by Yann Savary and additional data sources</li>' +\r\n                '<li>Spots:  <a href=\"https://paraglidingspots.com\" target=\"_blank\">paraglidingspots.com</a> by Karsten Ehlers</li>' +\r\n                '<li>and many more open source libraries, projects, and artwork</li>' +\r\n                '</ul>' +\r\n                '<p>This map combines various data sources for aerial sports navigation.</p></div>';\r\n            \r\n            L.popup({ className: 'info-popup', autoPan: true })\r\n                .setLatLng(map.getCenter())\r\n                .setContent(popupContent)\r\n                .openOn(map);\r\n        });\r\n\r\n        return container;\r\n    }\r\n});\r\n\r\nexport default InfoControl;","// airspaces.js\n// Store the airspace click handler as a module-level variable so we can reference it later\nlet airspaceClickHandler = null;\nlet currentLowerLimit = 3000; // Default value matching dropdown\nlet airspaceDebounceTimer;\n\n\n// Add the convertToMeters function\nfunction convertToMeters(value, unitCode) {\n  switch (unitCode) {\n    case 1: // Feet to meters\n      return value * 0.3048;\n    case 2: // Meters (no conversion)\n      return value;\n    case 6: // Flight Level (FL * 100 ft to meters)\n      return value * 100 * 0.3048;\n    default:\n      return null; // Unknown unit\n  }\n}\n\nfunction fetchAirspaces() {\n  // Make sure map is available\n  if (!window.map) {\n    console.error(\"Map not initialized yet\");\n    return;\n  }\n  \n  const center = window.map.getCenter();\n  const lat = center.lat.toFixed(6);\n  const lng = center.lng.toFixed(6);\n  const types = [0, 1, 3, 4, 5, 7, 26, 28];\n\n  const apiUrl = `${process.env.APP_DOMAIN}/api/airspaces?lat=${lat}&lng=${lng}&dist=200000&types=${encodeURIComponent(types.join(','))}`;\n\n  fetch(apiUrl)\n    .then(response => response.json())\n    .then(data => {\n      // Clear existing layers\n      window.airspaceEFG.clearLayers();\n\n      const airspaces = []; // Store polygons and data for later use\n\n      data.items.forEach(airspace => {\n        if (airspace.type === 0 && airspace.icaoClass === 4) {\n          return;\n        }\n\n        // Get current limit from dropdown\n        const selectedLimit = parseInt(document.getElementById('airspaceLowerLimit').value, 10);\n\n        // Filter based on lower limit converted to meters\n        const lowerLimit = airspace.lowerLimit;\n        if (!lowerLimit) return; // Skip if no lower limit data\n\n        const lowerLimitMeters = convertToMeters(lowerLimit.value, lowerLimit.unit);\n        if (lowerLimitMeters === null || lowerLimitMeters >= selectedLimit) {  // Modified line\n            return; // Now using dynamic limit from dropdown\n        }\n\n        if (airspace.geometry && airspace.geometry.type === \"Polygon\") {\n          const coordinates = airspace.geometry.coordinates[0].map(coord => [coord[1], coord[0]]);\n\n          const lowerLimit = airspace.lowerLimit.value;\n          const color = lowerLimit === 0 ? \"red\" : \"blue\";\n\n          const airspaceTypeText = airspaceTypes[airspace.type] || \"Unknown\";\n          const icaoClassText = icaoClasses[airspace.icaoClass] || \"Unknown\";\n\n          const polygon = L.polygon(coordinates, {\n            color: color,\n            weight: 2,\n            fillOpacity: 0.3\n          });\n\n          // Store airspace data with its polygon\n          airspaces.push({ polygon, data: airspace });\n\n          window.airspaceEFG.addLayer(polygon);\n        }\n      });\n\n      console.log(`Added ${airspaces.length} airspaces to the map`);\n\n      // Remove any existing click listeners to avoid duplicates\n      if (airspaceClickHandler) {\n        window.map.off(\"click\", airspaceClickHandler);\n      }\n\n      // Create a new click handler that captures the airspaces in its closure\n      airspaceClickHandler = function(e) {\n        // Check if the airspace layer is actually visible before processing clicks\n        if (!window.map.hasLayer(window.airspaceEFG)) {\n          return; // Exit if airspace layer is not visible\n        }\n\n        const clickedPoint = e.latlng;\n        const overlappingAirspaces = [];\n\n        airspaces.forEach(({ polygon, data }) => {\n          if (polygon.getBounds().contains(clickedPoint)) {\n            overlappingAirspaces.push(data);\n          }\n        });\n\n        if (overlappingAirspaces.length > 0) {\n          const popupContent = overlappingAirspaces.map(a => `\n            <b>${a.name}</b><br>\n            Type: ${airspaceTypes[a.type] || \"Unknown\"}<br>\n            ICAO Class: ${icaoClasses[a.icaoClass] || \"Unknown\"}<br>\n            ID: ${a._id}<br>\n            ${a.lowerLimit.value} ${getUnit(a.lowerLimit.unit)}  ${a.upperLimit.value} ${getUnit(a.upperLimit.unit)}<br>\n          `).join(\"<hr>\");\n\n          L.popup()\n            .setLatLng(clickedPoint)\n            .setContent(popupContent)\n            .openOn(window.map);\n        }\n      };\n      \n      // Add the new click handler\n      window.map.on(\"click\", airspaceClickHandler);\n    })\n    .catch(error => console.error(\"Error fetching airspaces:\", error));\n}\n\n// Lookup tables for airspace type and ICAO class\n\nconst airspaceTypes = {\n  0: \"Other\",\n  1: \"Restricted\",\n  2: \"Danger (D)\",\n  3: \"Prohibited (Parc reserve)\",\n  4: \"Controlled Tower Region (CTR)\",\n  5: \"Transponder Mandatory Zone (TMZ)\",\n  6: \"Radio Mandatory Zone (RMZ)\",\n  7: \"Terminal Maneuvering Area (TMA)\",\n  8: \"Temporary Reserved Area (TRA)\",\n  9: \"Temporary Segregated Area (TSA)\",\n  10: \"Flight Information Region (FIR)\",\n  11: \"Upper Flight Information Region (UIR)\",\n  12: \"Air Defense Identification Zone (ADIZ)\",\n  13: \"Airport Traffic Zone (ATZ)\",\n  14: \"Military Airport Traffic Zone (MATZ)\",\n  15: \"Airway\",\n  16: \"Military Training Route (MTR)\",\n  17: \"Alert Area\",\n  18: \"Warning Area\",\n  19: \"Protected Area\",\n  20: \"Helicopter Traffic Zone (HTZ)\",\n  21: \"Gliding Sector\",\n  22: \"Transponder Setting (TRP)\",\n  23: \"Traffic Information Zone (TIZ)\",\n  24: \"Traffic Information Area (TIA)\",\n  25: \"Military Training Area (MTA)\",\n  26: \"Control Area (CTA)\",\n  27: \"ACC Sector (ACC)\",\n  28: \"Aerial Sporting Or Recreational Activity\",\n  29: \"Low Altitude Overflight Restriction\",\n  30: \"Military Route (MRT)\",\n  31: \"TSA/TRA Feeding Route (TFR)\",\n  32: \"VFR Sector\",\n  33: \"FIS Sector\",\n  34: \"Lower Traffic Area (LTA)\",\n  35: \"Upper Traffic Area (UTA)\"\n};\n\nconst icaoClasses = {\n  0: \"A\",\n  1: \"B\",\n  2: \"C\",\n  3: \"D\",\n  4: \"E\",\n  5: \"F\",\n  6: \"G\",\n  8: \"Special Use Airspace (SUA)\"\n};\n\nfunction getUnit(unitCode) {\n  const units = {\n    1: \"ft\", // Feet\n    2: \"m\",\n    6: \"FL\"  // Flight Level\n  };\n  return units[unitCode] || \"Unknown\";\n}\n\n\n// Export the fetchAirspaces function to make it globally available\nwindow.fetchAirspaces = fetchAirspaces;\n\n// Listen for map layer visibility changes\ndocument.addEventListener('map_initialized', function() {\n  console.log(\"Setting up airspace layer events\");\n  \n  // Add event listener for when the airspace layer is added to the map\n  window.map.on('overlayadd', function(e) {\n    if (e.name === 'Airspaces' || e.name === 'Gliding' || e.name === 'Notam') {\n      console.log(`Overlay added: ${e.name}, fetching airspaces`);\n      fetchAirspaces();\n    }\n  });\n\n  // Add event listener with debouncing\ndocument.addEventListener('DOMContentLoaded', function() {\n  document.body.addEventListener('change', function(e) {\n    if (e.target && e.target.id === 'airspaceLowerLimit') {\n      const newLimit = parseInt(e.target.value, 10);\n      \n      // Only update if value changed\n      if (newLimit !== currentLowerLimit) {\n        currentLowerLimit = newLimit;\n        \n        // Clear any pending debounce\n        clearTimeout(airspaceDebounceTimer);\n        \n        // Debounce to prevent rapid successive requests\n        airspaceDebounceTimer = setTimeout(() => {\n          if (window.map.hasLayer(window.airspaceEFG)) {\n            console.log(`Lower limit changed to ${newLimit}m, reloading airspaces`);\n            fetchAirspaces();\n          }\n        }, 300); // 300ms debounce delay\n      }\n    }\n  });\n});\n\n\n  // Also set up the moveend event to refresh airspaces when panning/zooming\n  window.map.on('moveend', function() {\n    // Only fetch if the layer is currently visible\n    if (window.map.hasLayer(window.airspaceEFG)) {\n      console.log(\"Map moved, refreshing airspaces\");\n      fetchAirspaces();\n    }\n  });\n});\n\n\n// Don't auto-fetch on script load - wait for the layer to be enabled\n// Remove or comment out: fetchAirspaces();","// airspaces.js\n// Store the airspace click handler as a module-level variable so we can reference it later\nlet airspaceClickHandler = null;\n\nfunction fetchAirspacesGliding() {\n  // Make sure map is available\n  if (!window.map) {\n    console.error(\"Map not initialized yet\");\n    return;\n  }\n  \n  const center = window.map.getCenter();\n  const lat = center.lat.toFixed(6);\n  const lng = center.lng.toFixed(6);\n  const types = [21];\n\n  const apiUrl = `${process.env.APP_DOMAIN}/api/airspaces?lat=${lat}&lng=${lng}&dist=200000&types=${encodeURIComponent(types.join(','))}`;\n\n  fetch(apiUrl)\n    .then(response => response.json())\n    .then(data => {\n      // Clear existing layers\n      window.airspaceGliding.clearLayers();\n\n      const airspaces = []; // Store polygons and data for later use\n\n      data.items.forEach(airspace => {\n        if (airspace.type === 0 && airspace.icaoClass === 4) {\n          return;\n        }\n\n        if (airspace.geometry && airspace.geometry.type === \"Polygon\") {\n          const coordinates = airspace.geometry.coordinates[0].map(coord => [coord[1], coord[0]]);\n\n          const lowerLimit = airspace.lowerLimit.value;\n          const color = lowerLimit === 0 ? \"red\" : \"green\";\n\n          const airspaceTypeText = airspaceTypes[airspace.type] || \"Unknown\";\n          const icaoClassText = icaoClasses[airspace.icaoClass] || \"Unknown\";\n\n          const polygon = L.polygon(coordinates, {\n            color: color,\n            weight: 2,\n            fillOpacity: 0.3\n          });\n\n          // Store airspace data with its polygon\n          airspaces.push({ polygon, data: airspace });\n\n          window.airspaceGliding.addLayer(polygon);\n        }\n      });\n\n      console.log(`Added ${airspaces.length} airspaces to the map`);\n\n      // Remove any existing click listeners to avoid duplicates\n      if (airspaceClickHandler) {\n        window.map.off(\"click\", airspaceClickHandler);\n      }\n\n      // Create a new click handler that captures the airspaces in its closure\n      airspaceClickHandler = function(e) {\n        // Check if the airspace layer is actually visible before processing clicks\n        if (!window.map.hasLayer(window.airspaceGliding)) {\n          return; // Exit if airspace layer is not visible\n        }\n\n        const clickedPoint = e.latlng;\n        const overlappingAirspaces = [];\n\n        airspaces.forEach(({ polygon, data }) => {\n          if (polygon.getBounds().contains(clickedPoint)) {\n            overlappingAirspaces.push(data);\n          }\n        });\n\n        if (overlappingAirspaces.length > 0) {\n          const popupContent = overlappingAirspaces.map(a => `\n            <b>${a.name}</b><br>\n            Type: ${airspaceTypes[a.type] || \"Unknown\"}<br>\n            ICAO Class: ${icaoClasses[a.icaoClass] || \"Unknown\"}<br>\n            ${a.lowerLimit.value} ${getUnit(a.lowerLimit.unit)}  ${a.upperLimit.value} ${getUnit(a.upperLimit.unit)}<br>\n          `).join(\"<hr>\");\n\n          L.popup()\n            .setLatLng(clickedPoint)\n            .setContent(popupContent)\n            .openOn(window.map);\n        }\n      };\n      \n      // Add the new click handler\n      window.map.on(\"click\", airspaceClickHandler);\n    })\n    .catch(error => console.error(\"Error fetching airspaces:\", error));\n}\n\n// Lookup tables for airspace type and ICAO class\n\nconst airspaceTypes = {\n  0: \"Other\",\n  1: \"Restricted\",\n  2: \"Danger (D)\",\n  3: \"Prohibited (Parc reserve)\",\n  4: \"Controlled Tower Region (CTR)\",\n  5: \"Transponder Mandatory Zone (TMZ)\",\n  6: \"Radio Mandatory Zone (RMZ)\",\n  7: \"Terminal Maneuvering Area (TMA)\",\n  8: \"Temporary Reserved Area (TRA)\",\n  9: \"Temporary Segregated Area (TSA)\",\n  10: \"Flight Information Region (FIR)\",\n  11: \"Upper Flight Information Region (UIR)\",\n  12: \"Air Defense Identification Zone (ADIZ)\",\n  13: \"Airport Traffic Zone (ATZ)\",\n  14: \"Military Airport Traffic Zone (MATZ)\",\n  15: \"Airway\",\n  16: \"Military Training Route (MTR)\",\n  17: \"Alert Area\",\n  18: \"Warning Area\",\n  19: \"Protected Area\",\n  20: \"Helicopter Traffic Zone (HTZ)\",\n  21: \"Gliding Sector\",\n  22: \"Transponder Setting (TRP)\",\n  23: \"Traffic Information Zone (TIZ)\",\n  24: \"Traffic Information Area (TIA)\",\n  25: \"Military Training Area (MTA)\",\n  26: \"Control Area (CTA)\",\n  27: \"ACC Sector (ACC)\",\n  28: \"Aerial Sporting Or Recreational Activity\",\n  29: \"Low Altitude Overflight Restriction\",\n  30: \"Military Route (MRT)\",\n  31: \"TSA/TRA Feeding Route (TFR)\",\n  32: \"VFR Sector\",\n  33: \"FIS Sector\",\n  34: \"Lower Traffic Area (LTA)\",\n  35: \"Upper Traffic Area (UTA)\"\n};\n\nconst icaoClasses = {\n  0: \"A\",\n  1: \"B\",\n  2: \"C\",\n  3: \"D\",\n  4: \"E\",\n  5: \"F\",\n  6: \"G\",\n  8: \"Special Use Airspace (SUA)\"\n};\n\nfunction getUnit(unitCode) {\n  const units = {\n    1: \"ft\", // Feet\n    6: \"FL\"  // Flight Level\n  };\n  return units[unitCode] || \"Unknown\";\n}\n\n\n// Export the fetchAirspacesGliding function to make it globally available\nwindow.fetchAirspacesGliding = fetchAirspacesGliding;\n\n// Listen for map layer visibility changes\ndocument.addEventListener('map_initialized', function() {\n  console.log(\"Setting up airspace layer events\");\n  \n  // Add event listener for when the airspace layer is added to the map\n  window.map.on('overlayadd', function(e) {\n    if (e.name === 'Airspaces' || e.name === 'Gliding' || e.name === 'Notam') {\n      console.log(`Overlay added: ${e.name}, fetching airspaces`);\n      fetchAirspacesGliding();\n    }\n  });\n  \n  // Also set up the moveend event to refresh airspaces when panning/zooming\n  window.map.on('moveend', function() {\n    // Only fetch if the layer is currently visible\n    if (window.map.hasLayer(window.airspaceGliding)) {\n      console.log(\"Map moved, refreshing airspaces\");\n      fetchAirspacesGliding();\n    }\n  });\n});\n\n// Don't auto-fetch on script load - wait for the layer to be enabled\n// Remove or comment out: fetchAirspacesGliding();","// airspaces.js\n// Store the airspace click handler as a module-level variable so we can reference it later\nlet airspaceClickHandler = null;\n\nfunction fetchAirspacesNotam() {\n  // Make sure map is available\n  if (!window.map) {\n    console.error(\"Map not initialized yet\");\n    return;\n  }\n  \n  const center = window.map.getCenter();\n  const lat = center.lat.toFixed(6);\n  const lng = center.lng.toFixed(6);\n  const types = [8, 9];\n\n  const apiUrl = `${process.env.APP_DOMAIN}/api/airspaces?lat=${lat}&lng=${lng}&dist=200000&types=${encodeURIComponent(types.join(','))}`;\n\n  fetch(apiUrl)\n    .then(response => response.json())\n    .then(data => {\n      // Clear existing layers\n      window.airspaceNotam.clearLayers();\n\n      const airspaces = []; // Store polygons and data for later use\n\n      data.items.forEach(airspace => {\n        if (airspace.type === 0 && airspace.icaoClass === 4) {\n          return;\n        }\n\n        if (airspace.geometry && airspace.geometry.type === \"Polygon\") {\n          const coordinates = airspace.geometry.coordinates[0].map(coord => [coord[1], coord[0]]);\n\n          const lowerLimit = airspace.lowerLimit.value;\n          const color = lowerLimit === 0 ? \"red\" : \"blue\";\n\n          const airspaceTypeText = airspaceTypes[airspace.type] || \"Unknown\";\n          const icaoClassText = icaoClasses[airspace.icaoClass] || \"Unknown\";\n\n          const polygon = L.polygon(coordinates, {\n            color: color,\n            weight: 2,\n            fillOpacity: 0.3\n          });\n\n          // Store airspace data with its polygon\n          airspaces.push({ polygon, data: airspace });\n\n          window.airspaceNotam.addLayer(polygon);\n        }\n      });\n\n      console.log(`Added ${airspaces.length} airspaces to the map`);\n\n      // Remove any existing click listeners to avoid duplicates\n      if (airspaceClickHandler) {\n        window.map.off(\"click\", airspaceClickHandler);\n      }\n\n      // Create a new click handler that captures the airspaces in its closure\n      airspaceClickHandler = function(e) {\n        // Check if the airspace layer is actually visible before processing clicks\n        if (!window.map.hasLayer(window.airspaceNotam)) {\n          return; // Exit if airspace layer is not visible\n        }\n\n        const clickedPoint = e.latlng;\n        const overlappingAirspaces = [];\n\n        airspaces.forEach(({ polygon, data }) => {\n          if (polygon.getBounds().contains(clickedPoint)) {\n            overlappingAirspaces.push(data);\n          }\n        });\n\n        if (overlappingAirspaces.length > 0) {\n          const popupContent = overlappingAirspaces.map(a => `\n            <b>${a.name}</b><br>\n            Type: ${airspaceTypes[a.type] || \"Unknown\"}<br>\n            ICAO Class: ${icaoClasses[a.icaoClass] || \"Unknown\"}<br>\n            ${a.lowerLimit.value} ${getUnit(a.lowerLimit.unit)}  ${a.upperLimit.value} ${getUnit(a.upperLimit.unit)}<br>\n          `).join(\"<hr>\");\n\n          L.popup()\n            .setLatLng(clickedPoint)\n            .setContent(popupContent)\n            .openOn(window.map);\n        }\n      };\n      \n      // Add the new click handler\n      window.map.on(\"click\", airspaceClickHandler);\n    })\n    .catch(error => console.error(\"Error fetching airspaces:\", error));\n}\n\n// Lookup tables for airspace type and ICAO class\n\nconst airspaceTypes = {\n  0: \"Other\",\n  1: \"Restricted\",\n  2: \"Danger (D)\",\n  3: \"Prohibited (Parc reserve)\",\n  4: \"Controlled Tower Region (CTR)\",\n  5: \"Transponder Mandatory Zone (TMZ)\",\n  6: \"Radio Mandatory Zone (RMZ)\",\n  7: \"Terminal Maneuvering Area (TMA)\",\n  8: \"Temporary Reserved Area (TRA)\",\n  9: \"Temporary Segregated Area (TSA)\",\n  10: \"Flight Information Region (FIR)\",\n  11: \"Upper Flight Information Region (UIR)\",\n  12: \"Air Defense Identification Zone (ADIZ)\",\n  13: \"Airport Traffic Zone (ATZ)\",\n  14: \"Military Airport Traffic Zone (MATZ)\",\n  15: \"Airway\",\n  16: \"Military Training Route (MTR)\",\n  17: \"Alert Area\",\n  18: \"Warning Area\",\n  19: \"Protected Area\",\n  20: \"Helicopter Traffic Zone (HTZ)\",\n  21: \"Gliding Sector\",\n  22: \"Transponder Setting (TRP)\",\n  23: \"Traffic Information Zone (TIZ)\",\n  24: \"Traffic Information Area (TIA)\",\n  25: \"Military Training Area (MTA)\",\n  26: \"Control Area (CTA)\",\n  27: \"ACC Sector (ACC)\",\n  28: \"Aerial Sporting Or Recreational Activity\",\n  29: \"Low Altitude Overflight Restriction\",\n  30: \"Military Route (MRT)\",\n  31: \"TSA/TRA Feeding Route (TFR)\",\n  32: \"VFR Sector\",\n  33: \"FIS Sector\",\n  34: \"Lower Traffic Area (LTA)\",\n  35: \"Upper Traffic Area (UTA)\"\n};\n\nconst icaoClasses = {\n  0: \"A\",\n  1: \"B\",\n  2: \"C\",\n  3: \"D\",\n  4: \"E\",\n  5: \"F\",\n  6: \"G\",\n  8: \"Special Use Airspace (SUA)\"\n};\n\nfunction getUnit(unitCode) {\n  const units = {\n    1: \"ft\", // Feet\n    6: \"FL\"  // Flight Level\n  };\n  return units[unitCode] || \"Unknown\";\n}\n\n\n// Export the fetchAirspacesNotam function to make it globally available\nwindow.fetchAirspacesNotam = fetchAirspacesNotam;\n\n// Listen for map layer visibility changes\ndocument.addEventListener('map_initialized', function() {\n  console.log(\"Setting up airspace layer events\");\n  \n  // Add event listener for when the airspace layer is added to the map\n  window.map.on('overlayadd', function(e) {\n    if (e.name === 'Airspaces' || e.name === 'Gliding' || e.name === 'Notam') {\n      console.log(`Overlay added: ${e.name}, fetching airspaces`);\n      fetchAirspacesNotam();\n    }\n  });\n  \n  // Also set up the moveend event to refresh airspaces when panning/zooming\n  window.map.on('moveend', function() {\n    // Only fetch if the layer is currently visible\n    if (window.map.hasLayer(window.airspaceNotam)) {\n      console.log(\"Map moved, refreshing airspaces\");\n      fetchAirspacesNotam();\n    }\n  });\n});\n\n// Don't auto-fetch on script load - wait for the layer to be enabled\n// Remove or comment out: fetchAirspacesNotam();","import moment from 'moment';\r\nimport 'moment-timezone'; \r\n\r\nlet airspaceClickHandler = null; \r\n\r\nfunction fetchAirspacesXC() {\r\n    // Make sure map is available\r\n    if (!window.map) {\r\n      console.error(\"Map not initialized yet\");\r\n      return;\r\n    }\r\n    \r\n    const center = window.map.getCenter();\r\n    const lat = center.lat.toFixed(6);\r\n    const lng = center.lng.toFixed(6);\r\n\r\n    // Get map bounds for the query\r\n    const bounds = window.map.getBounds();\r\n    const nw = bounds.getNorthWest();\r\n    const se = bounds.getSouthEast();\r\n    \r\n   // Format today's date (YYYY-MM-DD)\r\n   const today = new Date();\r\n        \r\n   const dateStr = `${today.getFullYear()}-${(today.getMonth()+1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;\r\n   \r\n   // Build API URL with parameters\r\n   const apiUrl = `${process.env.APP_DOMAIN}/api/airspacesXCdb?startDate=${dateStr}&nw_lat=${nw.lat.toFixed(6)}&nw_lng=${nw.lng.toFixed(6)}&se_lat=${se.lat.toFixed(6)}&se_lng=${se.lng.toFixed(6)}`;\r\n \r\n    fetch(apiUrl)\r\n    .then(response => response.json())\r\n    \r\n      .then(data => {\r\n        // Clear existing layers\r\n        window.airspaceXC.clearLayers();\r\n  \r\n        const airspaces = []; // Store polygons and data for later use\r\n\r\n      // Remove any existing click listeners to avoid duplicates\r\n      if (airspaceClickHandler) {\r\n        window.map.off(\"click\", airspaceClickHandler);\r\n        airspaceClickHandler = null; // Clean up reference\r\n      }\r\n  \r\n        // Check if data is a GeoJSON FeatureCollection\r\n        const features = data.features || [];\r\n\r\n        // Current date for expiration checking\r\n        const currentDate = new Date();\r\n        console.log(\"Current date for expiration checks:\", currentDate);\r\n\r\n        const intl = Intl.DateTimeFormat().resolvedOptions().timeZone;\r\n        const tzShort = moment.tz(intl).zoneAbbr();\r\n        console.log(tzShort);\r\n        \r\n        features.forEach(feature => {\r\n          if (feature.geometry && feature.geometry.type === \"Polygon\") {\r\n\r\n            // Skip airspaces with names starting with \"V00\"\r\n            if (feature.properties.name && feature.properties.name.startsWith(\"V00\")) {\r\n              return; // Skip this airspace\r\n            }\r\n\r\n            // Check for expiration date in descriptions\r\n            if (feature.properties.descriptions && Array.isArray(feature.properties.descriptions) && feature.properties.descriptions.length > 0) {\r\n              // Look for a C) pattern followed by a date in the descriptions\r\n              let isExpired = false;\r\n              \r\n              for (const desc of feature.properties.descriptions) {\r\n                const description = desc.airdescription || '';\r\n                const cMatch = description.match(/C\\)\\s*(\\d{10})/);\r\n                \r\n                if (cMatch && cMatch[1]) {\r\n                  // Extract the date in format YYMMDDHHMM (e.g., 2503141100)\r\n                  const dateStr = cMatch[1];\r\n                  \r\n                  try {\r\n                    // Parse parts - first 2 digits are YY\r\n                    const year = 2000 + parseInt(dateStr.substring(0, 2)); // Assuming all dates are in 21st century\r\n                    const month = parseInt(dateStr.substring(2, 4)) - 1; // JS months are 0-indexed\r\n                    const day = parseInt(dateStr.substring(4, 6));\r\n                    const hour = parseInt(dateStr.substring(6, 8));\r\n                    const minute = parseInt(dateStr.substring(8, 10));\r\n                    \r\n                    const expirationDate = new Date(year, month, day, hour, minute);\r\n                    \r\n                    console.log(`Airspace ${feature.properties.name} has expiration date: ${expirationDate}`);\r\n                    \r\n                    // Check if this airspace is expired\r\n                    if (expirationDate <= currentDate) {\r\n                      console.log(`Airspace ${feature.properties.name} is expired`);\r\n                      isExpired = true;\r\n                      break; // No need to check other descriptions\r\n                    }\r\n                  } catch (error) {\r\n                    console.error(\"Error parsing expiration date:\", error);\r\n                  }\r\n                }\r\n              }\r\n              \r\n              // Skip this airspace if it's expired\r\n              if (isExpired) {\r\n                return;\r\n              }\r\n            }\r\n\r\n\r\n            // Skip airspaces with airspaceClass = Q\r\n            // if (feature.properties.airspaceClass === \"Q\") {\r\n            //   return; // Skip this airspace\r\n            // }\r\n            // Get current limit from dropdown\r\n            const selectedLimit = parseInt(document.getElementById('airspaceLowerLimit').value, 10);\r\n            \r\n            // Extract lower limit information\r\n            const lowerLimitInfo = feature.properties.airlower_j;\r\n            if (!lowerLimitInfo) return; // Skip if no lower limit data\r\n            \r\n            // Convert to meters based on type\r\n            let lowerLimitMeters = null;\r\n            if (lowerLimitInfo.type === \"AMSL\") {\r\n              lowerLimitMeters = lowerLimitInfo.height * 0.3048; // Assuming height is in feet\r\n            } else if (lowerLimitInfo.type === \"FL\") {\r\n              lowerLimitMeters = lowerLimitInfo.height * 0.3048; // FL is in feet\r\n            } else if (lowerLimitInfo.type === \"AGL\") {\r\n              lowerLimitMeters = lowerLimitInfo.height * 0.3048; // AGL is in feet\r\n            }\r\n            \r\n            if (lowerLimitMeters === null || lowerLimitMeters >= selectedLimit) {\r\n              return; // Skip based on height filter\r\n            }\r\n            \r\n            // Use the coordinates directly from the GeoJSON\r\n            const coordinates = feature.geometry.coordinates[0].map(coord => [coord[1], coord[0]]);\r\n            \r\n            // Use styling from the properties\r\n            const polygon = L.polygon(coordinates, {\r\n              color: feature.properties.strokeColor || \"blue\",\r\n              weight: feature.properties.strokeWeight || 2,\r\n              fillColor: feature.properties.fillColor || \"blue\",\r\n              fillOpacity: feature.properties.fillOpacity || 0.3\r\n            });\r\n  \r\n            // Store airspace data with its polygon\r\n            airspaces.push({ polygon, data: feature.properties });\r\n  \r\n            window.airspaceXC.addLayer(polygon);\r\n          }\r\n        });\r\n  \r\n        console.log(`Added ${airspaces.length} airspaces to the map`);\r\n  \r\n        // Create a new click handler that captures the airspaces in its closure\r\n        airspaceClickHandler = function(e) {\r\n          // Check if the airspace layer is actually visible before processing clicks\r\n          if (!window.map.hasLayer(window.airspaceXC)) {\r\n            return; // Exit if airspace layer is not visible\r\n          }\r\n  \r\n          const clickedPoint = e.latlng;\r\n          const overlappingAirspaces = [];\r\n  \r\n          airspaces.forEach(({ polygon, data }) => {\r\n            if (polygon.getBounds().contains(clickedPoint)) {\r\n              overlappingAirspaces.push(data);\r\n            }\r\n          });\r\n  \r\n          if (overlappingAirspaces.length > 0) {\r\n              // Inside your click handler:\r\n              const tzName = moment.tz.guess(); // Gets the user's timezone like \"Europe/Berlin\"\r\n              const tzAbbreviation = moment.tz(tzName).zoneAbbr(); // Gets \"CET\"\r\n              const tzOffset = moment.tz(tzName).format('Z'); // Gets \"+01:00\"\r\n\r\n              const timezoneInfo = `<div class=\"timezone-info\" style=\"margin-top: 5px; font-size: 0.85em;\">Local timezone: ${tzAbbreviation} (UTC${tzOffset})</div>`;\r\n\r\n              const popupContent = overlappingAirspaces.map(a => {\r\n              // Create the description HTML if there are any descriptions\r\n              let descriptionsHtml = '';\r\n              // Check if descriptions exists and is actually an array with elements\r\n              if (a.descriptions && Array.isArray(a.descriptions) && a.descriptions.length > 0) {\r\n                // Function to format description text with line breaks before A), B), etc.\r\n                const formatDescription = (text) => {\r\n                  if (!text) return '';\r\n                  \r\n                  // Add line breaks before A), B), C), etc.\r\n                  return text.replace(/([ABCDEFGQ]\\))/g, '<br>$1');\r\n                };\r\n                \r\n                descriptionsHtml = `\r\n                  <div class=\"airspace-descriptions\" style=\"font-size: 0.8em;\">\r\n                      ${a.descriptions.map(desc => {\r\n                        const formattedDesc = formatDescription(desc.airdescription || '');\r\n                        return `${formattedDesc} ${desc.airlanguage ? `(${desc.airlanguage})` : ''}`;\r\n                      }).join('')}\r\n                  </div>\r\n                `;\r\n              }\r\n\r\n              // Create the description HTML if there are any descriptions\r\n              let activationsHtml = '';\r\n\r\n              // Check if activations exists and is actually an array with elements\r\n              if (a.activations && Array.isArray(a.activations) && a.activations.length > 0) {\r\n                activationsHtml = `\r\n                  <div class=\"airspace-activations\">\r\n                    <b>Activations:</b><br>\r\n                    ${a.activations.map(activation => {\r\n                      // Format the activation dates\r\n                      const startDate = new Date(activation[0]);\r\n                      const endDate = new Date(activation[1]);\r\n                      \r\n                      const formatDate = (date) => {\r\n                        return date.toLocaleString('en-US', {\r\n                          month: 'short',\r\n                          day: 'numeric',\r\n                          hour: '2-digit',\r\n                          minute: '2-digit',\r\n                          hour12: false\r\n                        });\r\n                      };\r\n                      \r\n                      return `${formatDate(startDate)} - ${formatDate(endDate)}`;\r\n                    }).join('<br>')}\r\n                  </div>\r\n                `;\r\n              }\r\n              \r\n              return `\r\n              <b>${a.name} (${a.airspaceClass})</b><br>\r\n              <b> </b>${a.lowerLimit} - <b> </b>${a.upperLimit}<br>\r\n              ${timezoneInfo}\r\n              </div>\r\n                ${descriptionsHtml}\r\n                ${activationsHtml}\r\n              </div>\r\n              `;\r\n            }).join(\"<hr style='margin: 3px 0;'>\");\r\n          \r\n            L.popup()\r\n              .setLatLng(clickedPoint)\r\n              .setContent(popupContent)\r\n              .openOn(window.map);\r\n          }\r\n        };\r\n        \r\n        // Add the new click handler\r\n        window.map.on(\"click\", airspaceClickHandler);\r\n      })\r\n      .catch(error => console.error(\"Error fetching airspaces:\", error));\r\n  }\r\n\r\n  window.fetchAirspacesXC = fetchAirspacesXC;","\n\nfunction getCompassDirection(deg) {\n  const directions = [\n    \"N\", \"NNE\", \"NE\", \"ENE\", \"E\", \"ESE\", \"SE\", \"SSE\",\n    \"S\", \"SSW\", \"SW\", \"WSW\", \"W\", \"WNW\", \"NW\", \"NNW\",\n  ];\n  return directions[Math.round(deg / 22.5) % 16];\n}\n\nfunction getFillColor(speed) {\n  if (speed >= 7 && speed <= 14) return \"LimeGreen\";\n  if (speed >= 15 && speed <= 24) return \"yellow\";\n  if (speed >= 25 && speed <= 30) return \"orange\";\n  if (speed >= 31 && speed <= 36) return \"red\";\n  if (speed > 36) return \"black\";\n  return \"Aquamarine\";\n}\n\nfunction getStrokeColor(speed) {\n  if (speed >= 15 && speed <= 24) return \"LimeGreen\";\n  if (speed >= 25 && speed <= 32) return \"yellow\";\n  if (speed >= 33 && speed <= 38) return \"orange\";\n  if (speed >= 39 && speed <= 44) return \"red\";\n  if (speed > 44) return \"black\";\n  return \"Aquamarine\";\n}\n\nfunction getTextColor(backgroundColor) {\n  return backgroundColor === \"black\" ? \"white\" : \"black\";\n}\n\n// Helper: Process raw historical data into 10minute averages.\nfunction processHistoricalData(data) {\n  const grouped = {};\n  data.forEach((entry) => {\n    const dt = new Date(entry._id * 1000);\n    // Round down to the nearest 10minute mark.\n    dt.setMinutes(Math.floor(dt.getMinutes() / 10) * 10);\n    dt.setSeconds(0);\n    dt.setMilliseconds(0);\n    const key = dt.getTime();\n    if (!grouped[key]) {\n      grouped[key] = { count: 0, wAvgSum: 0, wMaxSum: 0, wDirSum: 0, tempSum: 0, tempCount: 0 };\n    }\n    grouped[key].count++;\n    grouped[key].wAvgSum += entry[\"w-avg\"];\n    grouped[key].wMaxSum += entry[\"w-max\"];\n    grouped[key].wDirSum += entry[\"w-dir\"];\n    if (entry[\"temp\"] !== undefined) {\n      grouped[key].tempSum += entry[\"temp\"];\n      grouped[key].tempCount++;\n    }\n  });\n  const result = Object.keys(grouped).map((key) => ({\n    _id: parseInt(key) / 1000, // back to seconds\n    \"w-avg\": grouped[key].wAvgSum / grouped[key].count,\n    \"w-max\": grouped[key].wMaxSum / grouped[key].count,\n    \"w-dir\": grouped[key].wDirSum / grouped[key].count,\n    \"temp\": grouped[key].tempCount > 0 ? grouped[key].tempSum / grouped[key].tempCount : undefined,\n  }));\n  // For the table we want descending order (most recent first).\n  result.sort((a, b) => b._id - a._id);\n  return result;\n}\n\n// Main function to fetch and display wind stations.\nfunction fetchWindStations() {\n    // Make sure the map exists before trying to use it\n    if (!window.map || typeof window.map.getBounds !== 'function') {\n      console.error('Map not properly initialized');\n      return;\n    }\n\n  const bounds = window.map.getBounds();\n  const nwLat = bounds.getNorthWest().lat;\n  const nwLng = bounds.getNorthWest().lng;\n  const seLat = bounds.getSouthEast().lat;\n  const seLng = bounds.getSouthEast().lng;\n  fetch(\n    `${process.env.APP_DOMAIN}/api/wind-data-getCurrent?nwLat=${nwLat}&nwLng=${nwLng}&seLat=${seLat}&seLng=${seLng}`\n  )\n    .then((response) => response.json())\n    .then((responseData) => {\n      if (!Array.isArray(responseData)) {\n        throw new Error(\"Invalid data format received from API\");\n      }\n      // Clear previous markers.\n      windLayer.clearLayers();\n      console.log('Wind layers cleared'); // Add this\n\n      responseData.forEach((station) => {\n        const [lon, lat] = station.loc.coordinates;\n        const windDirection = station.last[\"w-dir\"];\n        const windAvg = station.last[\"w-avg\"];\n        const windMax = station.last[\"w-max\"];\n        const tempC = station.last[\"temp\"];\n        const compassDirection = getCompassDirection(windDirection);\n        const lastUpdate = new Date(station.last[\"_id\"] * 1000).toLocaleTimeString(\"de-DE\", {hour: \"2-digit\", minute: \"2-digit\", });\n        const fillColor = getFillColor(windAvg);\n        const strokeColor = getStrokeColor(windMax);\n        const peakArrow = station.peak ? \"\" : \"\";\n        const isHolfuy = station._id.includes(\"holfuy\");\n        let holfuyStationId = '';\n        if (isHolfuy) {\n          holfuyStationId = station._id.split(\"-\")[1];\n        }\n\n        // Create the SVG arrow icon.\n        const arrowSvg = `\n          <svg width=\"30\" height=\"30\" viewBox=\"0 0 800 900\" xmlns=\"http://www.w3.org/2000/svg\">\n            <g transform=\"rotate(${windDirection + 90}, 400, 400)\" stroke=\"${strokeColor}\" stroke-width=\"60\">\n              <path d=\"M203,391 L75,144 L738,391 L75,637 L203,391 Z\" fill=\"${fillColor}\"/>\n            </g>\n            <text x=\"330\" y=\"850\" font-size=\"220\" text-anchor=\"middle\" fill=\"black\" font-weight=\"bold\">\n              ${peakArrow}${Math.round(windAvg)} / ${Math.round(windMax)}\n            </text>\n          </svg>`;\n\n        const arrowIcon = L.divIcon({\n          className: \"wind-arrow\",\n          html: arrowSvg,\n          iconSize: [30, 30],\n          iconAnchor: [12, 15],\n        });\n\n        // Create the marker.\n        const marker = L.marker([lat, lon], { icon: arrowIcon }).addTo(windLayer);\n\n        // Fetch historical data for this station.\n        fetch(\n          `https://winds.mobi/api/2.3/stations/${station._id}/historic/?duration=21000&keys=w-dir&keys=w-avg&keys=w-max&keys=temp`\n        )\n          .then((response) => response.json())\n          .then((historyData) => {\n            // Process historyData into 10minute averages.\n            const aggregatedData = processHistoricalData(historyData);\n\n            // --- TABLE SETUP (10minute averages, limited to last 5 hours) ---\n            const fiveHoursAgo = Date.now() - 5 * 60 * 60 * 1000;\n            const limitedData = aggregatedData.filter(\n              (entry) => entry._id * 1000 >= fiveHoursAgo\n            );\n            let historyTable = `<table border=\"1\" style=\"border-collapse: collapse; width: 100%; text-align: center;\">\n              <thead>\n                <tr>\n                  <th>Wind (m/s)</th>\n                  <th>Gusts (m/s)</th>\n                  <th>Direction</th>\n                  <th>Temp C</th>\n                  <th>Time</th>\n                </tr>\n              </thead>\n              <tbody>`;\n            limitedData.forEach((entry) => {\n              const timeFormatted = new Date(entry._id * 1000).toLocaleTimeString(\"de-DE\", {\n                hour: \"2-digit\",\n                minute: \"2-digit\",\n              });\n              const compassDir = getCompassDirection(entry[\"w-dir\"]);\n              historyTable += `<tr>\n                <td style=\"color: ${getTextColor(getFillColor(entry[\"w-avg\"]))}; background-color: ${getFillColor(entry[\"w-avg\"])};\">\n                  ${entry[\"w-avg\"].toFixed(1)}\n                </td>\n                <td style=\"color: ${getTextColor(getStrokeColor(entry[\"w-max\"]))}; background-color: ${getStrokeColor(entry[\"w-max\"])};\">\n                  ${entry[\"w-max\"].toFixed(1)}\n                </td>\n                <td>\n                  <span style=\"display: inline-block; transform: rotate(${entry[\"w-dir\"] + 180}deg);\"><strong> </strong></span>\n                  ${compassDir}\n                </td>\n                <td>${entry[\"temp\"] !== undefined ? entry[\"temp\"].toFixed(1) : \"N/A\"}</td>\n                <td>${timeFormatted}</td>\n              </tr>`;\n            });\n            historyTable += `</tbody></table>`;\n\n            // --- CHART SETUP (10minute averages with hourly vertical grid lines) ---\n            // For the chart we want ascending order (oldest first).\n            const chartData = aggregatedData.slice().reverse();\n\n            // Build the popup HTML with tabs.\n            const popupHtml = `\n              <div style=\"display: flex; gap: 1px; align-items: flex-start;\">\n                <div style=\"flex: 1;\">\n                  <strong>${station.short}</strong><br><br>\n                  <tag-name style=\"white-space:pre\">Wind Speed:&#9;&#9;${windAvg} km/h<br></tag-name>\n                  <tag-name style=\"white-space:pre\">Max Wind:&#9;&#9;${windMax} km/h<br></tag-name>\n                  <tag-name style=\"white-space:pre\">Wind Direction:&#9;${windDirection} (${compassDirection})<br></tag-name>\n                  <tag-name style=\"white-space:pre\">Last Update:&#9;&#9;${lastUpdate}<br><br></tag-name>\n                </div>\n                ${isHolfuy ? `\n                  <div style=\"flex: 0 0 auto; width: 110px;\">\n                    <iframe src=\"https://widget.holfuy.com/?station=${holfuyStationId}&su=km/h&t=C&lang=en&mode=rose&size=110\"\n                      width=\"160\"\n                      height=\"110\"\n                      frameborder=\"0\"\n                      scrolling=\"no\">\n                    </iframe>\n                  </div>\n                ` : ''}\n              </div>\n              \n              <div class=\"tab-container\">\n                <div class=\"tab active\" onclick=\"showTab('table-${station._id}', this)\">Table</div>\n                <div class=\"tab\" onclick=\"showTab('chart-${station._id}', this)\">Chart</div>\n                <div class=\"tab\" id=\"camera-tab-${station._id}\" style=\"display: none;\" onclick=\"showTab('camera-${station._id}', this)\">Camera</div>\n              </div>\n              <div id=\"table-${station._id}\" class=\"tab-content\">\n                ${historyTable}\n              </div>\n              <div id=\"chart-${station._id}\" class=\"tab-content\" style=\"display: none;\">\n                <canvas id=\"canvas-${station._id}\" width=\"400\" height=\"200\"></canvas>\n              </div>\n              <div id=\"camera-${station._id}\" class=\"tab-content\" style=\"display: none;\">\n                <img id=\"camera-image-${station._id}\" src=\"\" alt=\"Camera Image\" style=\"width: 100%; height: auto;\">\n              </div>\n            `;\n\n            // Bind a responsive popup using the plugin.\n            marker.bindPopup(\n              L.responsivePopup({\n                hasTip: true,\n                autoPan: false,\n                offset: [15, 25],\n                maxWidth: 560,\n                maxHeight: 800,\n              }).setContent(popupHtml)\n            );\n\n            // When the popup is opened, initialize the chart.\n            // When the popup is opened, initialize the chart.\n            marker.on(\"popupopen\", () => {\n              setTimeout(() => {\n                const canvas = document.getElementById(`canvas-${station._id}`);\n                if (canvas) {\n                  canvas.style.height = \"300px\";\n                  const ctx = canvas.getContext(\"2d\");\n                  if (ctx) {\n                    // Transform chartData so that each point has an x (timestamp) and y (value)\n                    const chartDataPointsAvg = chartData.map((entry) => ({\n                      x: entry._id * 1000, // convert seconds to ms\n                      y: entry[\"w-avg\"],\n                    }));\n                    const chartDataPointsMax = chartData.map((entry) => ({\n                      x: entry._id * 1000,\n                      y: entry[\"w-max\"],\n                    }));\n\n                    const chartInstance = new Chart(ctx, {\n                      type: \"line\",\n                      data: {\n                        datasets: [\n                          {\n                            label: \"Wind Avg (km/h)\",\n                            data: chartDataPointsAvg,\n                            borderColor: \"blue\",\n                            fill: false,\n                            pointRadius: 3,\n                          },\n                          {\n                            label: \"Wind Max (km/h)\",\n                            data: chartDataPointsMax,\n                            borderColor: \"red\",\n                            fill: false,\n                            pointRadius: 3,\n                          },\n                        ],\n                      },\n                      options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        layout: {\n                          // Add extra bottom padding so there's room for the arrows.\n                          padding: { bottom: 5 },\n                        },\n                        scales: {\n                          x: {\n                            type: \"time\",\n                            time: {\n                              unit: \"hour\",\n                              displayFormats: {\n                                hour: \"HH:mm\",\n                              },\n                              tooltipFormat: \"HH:mm\",\n                            },\n                            grid: {\n                              drawBorder: true,\n                            },\n                            ticks: {\n                              autoSkip: true,\n                              maxRotation: 0,\n                              minRotation: 0,\n                              padding: 30,\n                            },\n                          },\n                          y: {\n                            beginAtZero: true,\n                            ticks: {\n                              stepSize: 10,\n                              maxTicksLimit: 10,\n                              font: { size: 14 },\n                            },\n                          },\n                        },\n                        plugins: {\n                          legend: { display: false },\n                        },\n                      },\n                      plugins: [\n                        {\n                          id: \"windDirectionArrows\",\n                          afterDraw: (chart) => {\n                            const ctx = chart.ctx;\n                            const xAxis = chart.scales.x;\n                            ctx.save();\n                            // Position arrows just below the x-axis line \n                            const arrowRowY = xAxis.top + 20;\n                            \n                            // Set text properties for centered alignment\n                            ctx.textAlign = \"center\";\n                            ctx.textBaseline = \"middle\";\n                            \n                            chartData.forEach((entry) => {\n                              const x = xAxis.getPixelForValue(entry._id * 1000);\n                              ctx.save();\n                              ctx.translate(x, arrowRowY);\n                              ctx.rotate(((entry[\"w-dir\"] + 180) * Math.PI) / 180);\n                              ctx.font = \"18px Arial\";\n                              ctx.fillText(\"\", 0, 0);\n                              ctx.restore();\n                            });\n                            ctx.restore();\n                          },\n                        },\n                      ],\n                      \n                    });\n                    canvas.chartInstance = chartInstance;\n                  } else {\n                    console.error(\"Failed to get 2D context from canvas.\");\n                  }\n                } else {\n                  console.error(\"Canvas element not found.\");\n                }\n                // Inside the popupopen event handler where camera handling happens:\n                if (station._id.includes(\"holfuy\")) {\n                  const holfuyStationId = station._id.split(\"-\")[1];\n                  const cameraImageUrl = `https://holfuy.com/en/takeit/cam/s${holfuyStationId}.jpg`;\n                  const cameraImageElement = document.getElementById(`camera-image-${station._id}`);\n                  const cameraTabElement = document.getElementById(`camera-tab-${station._id}`);\n                  \n                  // Create temporary image to test validity\n                  const testImage = new Image();\n                  testImage.onload = function() {\n                    // Only show tab if image loads successfully\n                    cameraImageElement.src = cameraImageUrl;\n                    cameraTabElement.style.display = \"block\";\n                  };\n                  testImage.onerror = function() {\n                    // Hide tab if image fails to load\n                    cameraTabElement.style.display = \"none\";\n                  };\n                  testImage.src = cameraImageUrl;\n                  \n                  // Set timeout as fallback in case responses are slow\n                  setTimeout(() => {\n                    if (!testImage.complete || testImage.naturalWidth === 0) {\n                      cameraTabElement.style.display = \"none\";\n                    }\n                  }, 2000);\n                }\n              }, 500);\n            });\n\n          })\n          .catch((error) =>\n            console.error(\"Error fetching historical wind data:\", error)\n          );\n      });\n    })\n    .catch((error) =>\n      console.error(\"Error fetching wind station data:\", error)\n    );\n}\n\n// Enhanced tab switching function.\nwindow.showTab = function (tabId, element) {\n  console.log(\"Switching to tab:\", tabId);\n\n  document.querySelectorAll(\".tab-content\").forEach((tab) => {\n    tab.style.display = \"none\";\n  });\n\n  document.querySelectorAll(\".tab\").forEach((tab) => {\n    tab.classList.remove(\"active\");\n  });\n\n  const targetTab = document.getElementById(tabId);\n  if (targetTab) {\n    targetTab.style.display = \"block\";\n  } else {\n    console.error(\"Tab not found:\", tabId);\n  }\n\n  if (element) {\n    element.classList.add(\"active\");\n  } else {\n    console.error(\"Element is null or undefined\");\n  }\n\n  if (tabId.startsWith(\"chart-\")) {\n    const stationId = tabId.split(\"chart-\")[1];\n    console.log(\"Station ID:\", stationId);\n\n    const canvas = document.getElementById(`canvas-${stationId}`);\n    if (canvas) {\n      console.log(\"Canvas found:\", canvas);\n\n      if (canvas.chartInstance) {\n        console.log(\"Updating chart...\");\n        canvas.chartInstance.resize();\n        canvas.chartInstance.update();\n      } else {\n        console.warn(\"Chart instance not found on canvas:\", canvas);\n      }\n    } else {\n      console.error(\"Canvas not found for station ID:\", stationId);\n    }\n  }\n};\n\n\n\n// Initial fetch of wind stations.\nwindow.fetchWindStations = fetchWindStations;\n\n","// spotsHelper.js - Common functionality for loading and displaying spots on a map\r\n\r\n// Module-scoped variable to track Dropzone instance\r\nlet feedbackDropzone = null;\r\nlet currentFeedbackForm = null;\r\n\r\n// Swiper related functions\r\nfunction changeSwiper() {\r\n    if (typeof swiperc !== \"undefined\") {\r\n        if (window.innerWidth < 576) {\r\n            $(\".swiper2\").css(\"height\", \"\"); $(\".swiper2\").css(\"width\", \"320px\");\r\n            $(\".swiper2\").css(\"padding-left\", \"\"); $(\".swiper2\").css(\"padding-top\", \"30px\");\r\n            $(\".swiper2 > .swiper-wrapper\").css(\"width\", \"\"); $(\".swiper2 > .swiper-wrapper\").css(\"height\", \"100px\");\r\n            swiperc.changeDirection('horizontal', true);\r\n        }\r\n        else {\r\n            if (window.innerWidth < 840) {\r\n                $(\".swiper2\").css(\"width\", \"\"); $(\".swiper2\").css(\"height\", \"320px\");\r\n            }\r\n            else {\r\n                $(\".swiper2\").css(\"width\", \"\"); $(\".swiper2\").css(\"height\", \"460px\");\r\n            }\r\n            $(\".swiper2\").css(\"padding-top\", \"\"); $(\".swiper2\").css(\"padding-left\", \"30px\");\r\n            $(\".swiper2 > .swiper-wrapper\").css(\"height\", \"\"); $(\".swiper2 > .swiper-wrapper\").css(\"width\", \"100px\");\r\n            swiperc.changeDirection('vertical', true);\r\n        }\r\n    }\r\n}\r\n\r\nfunction initSwiper(idImg) {\r\n    let swiperv, swiperc;\r\n    // USED 09/24 Beschreibung: Initialisierung der Image-Swiper\r\n    var swiperLoop3 = (idImg < 4) ? false : true;\r\n    var swiperLoop4 = (idImg < 5) ? false : true;\r\n\r\n    swiperv = new Swiper('.swiper1', {\r\n        autoHeight: true,\r\n        direction: 'horizontal',\r\n        allowTouchMove: false,\r\n        mousewheel: false,\r\n        slidesPerView: 1,\r\n        loop: false,\r\n    });\r\n\r\n    swiperc = new Swiper('.swiper2', {\r\n        direction: 'vertical',\r\n        allowTouchMove: true,\r\n        mousewheel: true,\r\n        slidesPerView: 3,\r\n        spaceBetween: 10,\r\n        loop: swiperLoop3,\r\n        breakpoints: {\r\n            840: {\r\n                slidesPerView: 4,\r\n                loop: swiperLoop4\r\n            }\r\n        },\r\n        scrollbar: {\r\n            el: '.swiper-scrollbar',\r\n            hide: false,\r\n            draggable: true,\r\n        },\r\n        on: {\r\n            click: function() {\r\n                let iR = (this.clickedSlide.firstChild.id).substring(3) - 1;\r\n                swiperv.slideTo(iR, 1);\r\n            },\r\n            transitionEnd: function () {\r\n                let iR = this.realIndex;\r\n                swiperv.slideTo(iR, 1);\r\n            }\r\n        }\r\n    });\r\n\r\n    changeSwiper();\r\n}\r\n\r\n// Mapping wind directions to angles\r\nfunction getAngleRange(direction) {\r\n    const dirToAngle = {\r\n        \"N\": 0, \"NNE\": 22.5, \"NE\": 45, \"ENE\": 67.5,\r\n        \"E\": 90, \"ESE\": 112.5, \"SE\": 135, \"SSE\": 157.5,\r\n        \"S\": 180, \"SSW\": 202.5, \"SW\": 225, \"WSW\": 247.5,\r\n        \"W\": 270, \"WNW\": 292.5, \"NW\": 315, \"NNW\": 337.5\r\n    };\r\n\r\n    let angleRanges = [];\r\n    let parts = direction.split(',').map(part => part.trim());\r\n\r\n    parts.forEach(part => {\r\n        let range = part.split('-').map(dir => dir.trim());\r\n        if (range.length === 1) {\r\n            let angle = dirToAngle[range[0]];\r\n            if (angle !== undefined) {\r\n                angleRanges.push([angle - 22.5, angle + 22.5]);\r\n            }\r\n        } else if (range.length === 2) {\r\n            let start = dirToAngle[range[0]];\r\n            let end = dirToAngle[range[1]];\r\n            if (start !== undefined && end !== undefined) {\r\n                if (end < start) {\r\n                    [start, end] = [end, start];\r\n                }\r\n                if (end - start > 180) {\r\n                    [start, end] = [end, start];\r\n                }\r\n                angleRanges.push([start, end]);\r\n            }\r\n        }\r\n    });\r\n\r\n    return angleRanges;\r\n}\r\n\r\n// Fetch full place details when a popup is opened\r\nasync function loadPlaceDetails(layer, placeId) {\r\n    try {\r\n        const response = await fetch(`${process.env.APP_DOMAIN}/api/places/${placeId}`);\r\n        const data = await response.json();\r\n\r\n        if (data.error) {\r\n            console.error(\"Error fetching place details:\", data.error);\r\n            return;\r\n        }\r\n\r\n        let regex1 = /<center><b><a href=\"http:\\/\\/www\\.paraglidingearth\\.com\\/index\\.php\\?site=\\d+\">More information on ParaglidingEarth<\\/a><\\/b><\\/center>\\n?/g;\r\n        let regex2 = /<br>\\n<b>Take off : <\\/b><br>\\n?/g;\r\n        let regexHeight = /H \\d+(-\\d+)? m(?:, |<br>)/g;\r\n        let regexHD = /HD \\d+ m(?:<br>| \\/)/g;\r\n        let regexRating = /\\nrating \\d+\\/\\d+(?:\\n|<br>)*/gi;\r\n\r\n        let description = (data.properties.description || \"\")\r\n            .replace(regex1, \"\")\r\n            .replace(regex2, \"\")\r\n            .replace(regexHeight, \"\")\r\n            .replace(regexHD, \"\")\r\n            .replace(regexRating, \"\")\r\n            .trim();\r\n\r\n        window.currentPlaceName = data.properties.name;\r\n        window.currentPlaceId = data.properties.id; \r\n        window.currentStrPlacemarkId = data.properties.strPlacemarkId; \r\n\r\n        let popupContent = `<span style=\"color: #0087F7;\"><h5>${data.properties.name}</h5></span>\r\n                            <table style=\"border-collapse: collapse; width: 40%;\">\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Type:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.type}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Direction:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.direction}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Rating:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.rating != null ? data.properties.rating + '/6' : ' -'}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Height:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.height != null ? data.properties.height : ' -'}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Height difference:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.heightdifference != null ? data.properties.heightdifference : ' -'}</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <th style=\"text-align: left; vertical-align: top;\">Last Update:</th>\r\n                                <td style=\"text-align: left; vertical-align: top;\">${data.properties.lastupdate}</td>\r\n                            </tr>\r\n                            </table><br>\r\n                            <b>Description:</b> ${description}<br>\r\n                            <b> <a href=\"https://paraglidingspots.com\" target=\"_blank\">paraglidingspots.com</a></b>\r\n                            <div class=\"modal-footer d-flex justify-content-between\">\r\n                            <div id=\"feedback-message\" class=\"text-start\"></div> <!-- Message on the left -->\r\n                            <div class=\"d-flex ms-auto\">\r\n                                <button class=\"btn btn-primary me-2\" onclick=\"showFeebackForm()\">Feedback/Correction</button>\r\n                                <button class=\"btn btn-dark close-popup\">Close</button>\r\n                            </div>\r\n                            </div>\r\n                            `;\r\n\r\n        // Apply maxWidth CSS directly to popup content if needed\r\n        popupContent += `<style>\r\n        /* Limit the height of the Swiper container */\r\n        .swiper-container {\r\n            max-height: 460px !important;\r\n            height: 460px !important;\r\n            overflow: hidden !important;\r\n        }\r\n\r\n        /* Ensure individual Swipers don't expand beyond this height */\r\n        .swiper, .swiper1, .swiper2 {\r\n            max-height: 460px !important;\r\n            height: 460px !important;\r\n            overflow: hidden !important;\r\n        }\r\n\r\n        /* Limit Swiper wrapper height */\r\n        .swiper-wrapper {\r\n            max-height: 460px !important;\r\n        }\r\n\r\n        /* Ensure Swiper slides don't stretch */\r\n        .swiper-slide {\r\n            max-height: 460px !important;\r\n            display: flex !important;\r\n            align-items: center !important; /* Keep images centered */\r\n            justify-content: center !important;\r\n        }\r\n\r\n        /* Prevent images from exceeding the swiper height */\r\n        .swiper-slide img {\r\n            max-height: 100% !important;\r\n            width: auto !important;\r\n        }\r\n        \r\n        /* Keep the overall popup size unchanged */\r\n        .leaflet-popup-content {\r\n            max-height: 780px !important; /* Keep original popup height */\r\n            overflow-y: auto; /* Allow scrolling inside the popup if needed */\r\n        }\r\n\r\n        .swiper-clear {\r\n            clear: both;\r\n            margin-bottom: 1px;\r\n        }\r\n        </style>`;\r\n\r\n        layer.setPopupContent(popupContent);\r\n\r\n        // Wait for the popup to open before initializing Swiper\r\n        setTimeout(() => {\r\n            let firstImg = document.querySelector(\".swiper1 .swiper-slide img\");\r\n            if (firstImg) {\r\n                let idImg = parseInt(firstImg.id.replace(/\\D/g, \"\"), 10) || 1;\r\n                initSwiper(idImg); // Call existing Swiper function\r\n            }\r\n    \r\n        }, 300);\r\n\r\n        setTimeout(() => {\r\n            document.querySelector(\".close-popup\").addEventListener(\"click\", function () {\r\n                map.closePopup();\r\n            });\r\n        }, 300);\r\n\r\n    } catch (error) {\r\n        console.error(\"Error fetching place details:\", error);\r\n    }\r\n}\r\n\r\nfunction showFeebackForm() {\r\n    // Cleanup any existing feedback form\r\n    if (currentFeedbackForm) {\r\n        currentFeedbackForm.remove();\r\n        currentFeedbackForm = null;\r\n    }\r\n    if (feedbackDropzone) {\r\n        feedbackDropzone.destroy();\r\n        feedbackDropzone = null;\r\n    }\r\n    // Clear previous feedback message\r\n    const messageDiv = document.getElementById(\"feedback-message\");\r\n    if (messageDiv) {\r\n        messageDiv.textContent = \"\";\r\n         messageDiv.classList.remove(\"text-success\", \"text-danger\");\r\n    }\r\n\r\n    let modalFooter = document.querySelector(\".modal-footer\");\r\n    if (modalFooter) modalFooter.style.display = \"none\";\r\n\r\n    const feedbackFormHtml = `\r\n        <div id=\"feedbackFormHtml\">\r\n            <div class=\"feedback-modal\">\r\n                <span style=\"color: #0087F7;\"><h5>Feedback for ${window.currentPlaceName}</h5></span>\r\n                <form id=\"feedbackForm\">\r\n                    <div class=\"form-group\">\r\n                        <label for=\"feedbackText\">Feedback / Correction / Comment:</label>\r\n                        <textarea id=\"feedbackText\" class=\"form-control\" required style=\"height: 130px;\"></textarea>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label>Upload Images (optional):</label>\r\n                        <div id=\"dropzoneFeedback\" class=\"dropzone mt-4 border-dashed rounded-2 min-h-0\"></div>\r\n                    </div>\r\n                    <div class=\"form-group d-flex justify-content-between\">\r\n                        <div style=\"width: 48%;\">\r\n                            <label for=\"userName\">Name:</label>\r\n                            <input type=\"text\" id=\"userName\" class=\"form-control\" required>\r\n                        </div>\r\n                        <div style=\"width: 48%;\">\r\n                            <label for=\"userEmail\">E-Mail:</label>\r\n                            <input type=\"email\" id=\"userEmail\" class=\"form-control\" required>\r\n                            <small class=\"text-danger d-none\" id=\"emailError\">Please enter a valid email address.</small>\r\n                        </div>\r\n                    </div>\r\n                    <button type=\"submit\" class=\"btn btn-success\">Submit</button>\r\n                    <button type=\"button\" class=\"btn btn-secondary\" onclick=\"cancelFeedback()\">Cancel</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    const popup = document.querySelector(\".leaflet-popup-content\");\r\n    if (popup) {\r\n        popup.insertAdjacentHTML(\"beforeend\", feedbackFormHtml);\r\n        currentFeedbackForm = document.getElementById(\"feedbackFormHtml\");\r\n\r\n        // Auto-scroll implementation\r\n        setTimeout(() => {\r\n            const popupContainer = document.querySelector(\".leaflet-popup-content\");\r\n            if (popupContainer) {\r\n                popupContainer.scrollTo({\r\n                    top: popupContainer.scrollHeight,\r\n                    behavior: 'smooth'\r\n                });\r\n            }\r\n        }, 50); // 50ms delay to ensure DOM rendering\r\n    } else {\r\n        console.error(\"Popup content not found!\");\r\n        return;\r\n    }\r\n\r\n    // Initialize Dropzone\r\n    feedbackDropzone = new Dropzone(\"#dropzoneFeedback\", {\r\n        url: \"/upload\",\r\n        autoProcessQueue: false,\r\n        maxFiles: 5,\r\n        maxFilesize: 100,\r\n        acceptedFiles: \"image/*\",\r\n        addRemoveLinks: false,\r\n        dictDefaultMessage: \"Drag & drop files here or click to upload\",\r\n        clickable: true,\r\n        init: function() {\r\n            const dzInstance = this;\r\n            this.on(\"addedfile\", function(file) {\r\n                const previewElement = file.previewElement;\r\n                const deleteIcon = document.createElement(\"img\");\r\n                deleteIcon.src = \"/assets/images/imgdelete.png\";\r\n                deleteIcon.alt = \"Delete\";\r\n                deleteIcon.classList.add(\"delete-icon\");\r\n                previewElement.querySelector(\".dz-image\").appendChild(deleteIcon);\r\n\r\n                deleteIcon.addEventListener(\"click\", function(e) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    dzInstance.removeFile(file);\r\n                });\r\n            });\r\n\r\n            this.on(\"removedfile\", function(file) {\r\n                console.log(\"File removed:\", file.name);\r\n            });\r\n        }\r\n    });\r\n\r\n    // Email validation\r\n    document.getElementById(\"userEmail\").addEventListener(\"input\", function() {\r\n        const isValid = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(this.value);\r\n        document.getElementById(\"emailError\").classList.toggle(\"d-none\", isValid);\r\n    });\r\n\r\n    // Form submission\r\n    document.getElementById(\"feedbackForm\").addEventListener(\"submit\", async function(event) {\r\n        event.preventDefault();\r\n\r\n        const formData = new FormData();\r\n        formData.append(\"name\", window.currentPlaceName);\r\n        formData.append(\"id\", window.currentPlaceId);\r\n        formData.append(\"strPlacemarkId\", window.currentStrPlacemarkId);    \r\n        formData.append(\"feedbackText\", document.getElementById(\"feedbackText\").value);\r\n        formData.append(\"userName\", document.getElementById(\"userName\").value);\r\n        formData.append(\"userEmail\", document.getElementById(\"userEmail\").value);\r\n\r\n        feedbackDropzone.files.forEach(file => {\r\n            formData.append(\"images\", file);\r\n        });\r\n\r\n        try {\r\n            const response = await fetch(`${process.env.APP_DOMAIN}/api/send-feedback`, {\r\n                method: \"POST\",\r\n                body: formData\r\n            });\r\n            const result = await response.json();\r\n\r\n            // Cleanup after submission\r\n            if (currentFeedbackForm) {\r\n                currentFeedbackForm.remove();\r\n                currentFeedbackForm = null;\r\n            }\r\n            if (feedbackDropzone) {\r\n                feedbackDropzone.destroy();\r\n                feedbackDropzone = null;\r\n            }\r\n\r\n            const messageDiv = document.getElementById(\"feedback-message\");\r\n            if (result.success) {\r\n                messageDiv.textContent = result.message || \"Feedback submitted successfully!\";\r\n                messageDiv.classList.remove(\"text-danger\");\r\n                messageDiv.classList.add(\"text-success\");\r\n            } else {\r\n                messageDiv.textContent = result.error || \"An error occurred.\";\r\n                messageDiv.classList.remove(\"text-success\");\r\n                messageDiv.classList.add(\"text-danger\");\r\n            }\r\n            document.querySelector(\".modal-footer\").style.display = \"flex\";\r\n        } catch (error) {\r\n            console.error(\"Submission error:\", error);\r\n        }\r\n    });\r\n}\r\n\r\nfunction cancelFeedback() {\r\n    // Cleanup feedback form and Dropzone\r\n    if (currentFeedbackForm) {\r\n        currentFeedbackForm.remove();\r\n        currentFeedbackForm = null;\r\n    }\r\n    if (feedbackDropzone) {\r\n        feedbackDropzone.destroy();\r\n        feedbackDropzone = null;\r\n    }\r\n    document.querySelector(\".modal-footer\").style.display = \"flex\";\r\n}\r\n\r\n// Export functions\r\nexport {\r\n    changeSwiper,\r\n    initSwiper,\r\n    getAngleRange,\r\n    loadPlaceDetails,\r\n    showFeebackForm,\r\n    cancelFeedback\r\n};","import { \r\n    getAngleRange, \r\n    loadPlaceDetails, \r\n    showFeebackForm, \r\n    cancelFeedback \r\n} from './spotsHelper.js';\r\n\r\n// Use a module initialization function that waits for map to be ready\r\nexport function initSpotPG() {\r\n    // Check if map and placesLayerPG are available in the window object\r\n    if (!window.map || !window.placesLayerPG) {\r\n        console.error(\"Map or placesLayerPG is not defined. Retrying in 500ms...\");\r\n        setTimeout(initSpotPG, 500);\r\n        return;\r\n    }\r\n\r\n    console.log(\"Initializing PG spots module...\");\r\n\r\n    // Expose needed functions to global scope for event handlers\r\n    window.showFeebackForm = showFeebackForm;\r\n    window.cancelFeedback = cancelFeedback;\r\n\r\n    // Create cluster group and nest it in the existing layer group\r\n    const clusterGroup = L.markerClusterGroup({\r\n        disableClusteringAtZoom: 9,\r\n        spiderfyOnMaxZoom: true,\r\n        showCoverageOnHover: true,\r\n        zoomToBoundsOnClick: true,\r\n        maxClusterRadius: 250,\r\n        iconCreateFunction: function(cluster) {\r\n            return L.divIcon({ \r\n                html: `<div class=\"cluster-marker\">${cluster.getChildCount()}</div>`,\r\n                className: 'pg-cluster-icon',\r\n                iconSize: L.point(30, 30)\r\n            });\r\n        }\r\n    });\r\n\r\n    window.placesLayerPG.addLayer(clusterGroup);\r\n\r\n    // Track current fetch controller to allow cancellation\r\n    let currentFetchController = null;\r\n    // Add debounce timer\r\n    let fetchDebounceTimer = null;\r\n    const DEBOUNCE_DELAY = 300; // ms\r\n\r\n    // Fetch places without descriptions\r\n    function fetchPlaces() {\r\n        // Only proceed if the layer is on the map\r\n        if (!window.map.hasLayer(window.placesLayerPG)) {\r\n            console.log(\"PG layer not visible, skipping fetch\");\r\n            return;\r\n        }\r\n        \r\n        // Clear any pending debounce\r\n        if (fetchDebounceTimer) {\r\n            clearTimeout(fetchDebounceTimer);\r\n        }\r\n        \r\n        // Debounce the fetch call to prevent rapid successive requests\r\n        fetchDebounceTimer = setTimeout(() => {\r\n            // Cancel any ongoing fetch\r\n            if (currentFetchController) {\r\n                currentFetchController.abort();\r\n            }\r\n\r\n            // Create a new controller for this fetch\r\n            currentFetchController = new AbortController();\r\n            const signal = currentFetchController.signal;\r\n\r\n            const bounds = window.map.getBounds();\r\n            const nw_lat = bounds.getNorthWest().lat;\r\n            const nw_lng = bounds.getNorthWest().lng;\r\n            const se_lat = bounds.getSouthEast().lat;\r\n            const se_lng = bounds.getSouthEast().lng;\r\n\r\n            fetch(`${process.env.APP_DOMAIN}/api/places?nw_lat=${nw_lat}&nw_lng=${nw_lng}&se_lat=${se_lat}&se_lng=${se_lng}&type=TO&type=TOW&type=TH`, {\r\n                signal // Attach the abort signal to the fetch call\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    // Only process if this is still the active request\r\n                    if (signal.aborted) return;\r\n                    \r\n                    clusterGroup.clearLayers();\r\n\r\n                    L.geoJSON(data, {\r\n                        pointToLayer: function (feature, latlng) {\r\n                            return L.marker(latlng, {\r\n                                icon: L.canvasIcon({\r\n                                    iconSize: [50, 50],\r\n                                    iconAnchor: [15, 15],\r\n                                    drawIcon: function (icon, type) {\r\n                                        if (type === 'icon') {\r\n                                            var ctx = icon.getContext('2d');\r\n                                            var size = L.point(this.options.iconSize);\r\n                                            var center = L.point(size.x / 2, size.y / 2);\r\n                                            ctx.clearRect(0, 0, size.x, size.y);\r\n\r\n                                            let direction = feature.properties.direction || \"\";\r\n                                            let angleRanges = getAngleRange(direction);\r\n\r\n                                            ctx.beginPath();\r\n                                            angleRanges.forEach(([start, end]) => {\r\n                                                ctx.moveTo(center.x, center.y);\r\n                                                ctx.arc(center.x, center.y, center.x, (start - 90) * Math.PI / 180, (end - 90) * Math.PI / 180, false);\r\n                                                ctx.lineTo(center.x, center.y);\r\n                                            });\r\n                                            ctx.fillStyle = 'orange';\r\n                                            ctx.fill();\r\n                                            ctx.closePath();\r\n\r\n                                            ctx.beginPath();\r\n                                            ctx.arc(center.x, center.y, center.x / 4, 0, Math.PI * 2);\r\n                                            ctx.fillStyle = 'green';\r\n                                            ctx.fill();\r\n                                            ctx.closePath();\r\n                                        }\r\n                                    }\r\n                                })\r\n                            });\r\n                        },\r\n                        onEachFeature: function (feature, layer) {\r\n                            if (feature.properties) {\r\n                                let popupContent = `<b>${feature.properties.name}</b><br>\r\n                                                    Type: ${feature.properties.type}<br>\r\n                                                    Direction: ${feature.properties.direction}<br>\r\n                                                    <i>Loading details...</i>`;\r\n\r\n                                let responsivePopup = L.responsivePopup({\r\n                                    hasTip: true,\r\n                                    autoPan: false,\r\n                                    offset: [15, 25],\r\n                                    maxWidth: 900,\r\n                                    maxHeight: 780\r\n                                }).setContent(popupContent);\r\n\r\n                                layer.bindPopup(responsivePopup);\r\n\r\n                                layer.on(\"popupopen\", async function () {\r\n                                    await loadPlaceDetails(layer, feature.properties.id);\r\n                                });\r\n                            }\r\n                            \r\n                            clusterGroup.addLayer(layer);\r\n                        }\r\n                    });\r\n                    \r\n                    // Clear the controller reference when done\r\n                    currentFetchController = null;\r\n                })\r\n                .catch(error => {\r\n                    // Don't log aborted requests as errors\r\n                    if (error.name !== 'AbortError') {\r\n                        console.error(\"Error fetching PG places:\", error);\r\n                    }\r\n                });\r\n        }, DEBOUNCE_DELAY);\r\n    }\r\n\r\n    // IMPORTANT: Expose fetchPlaces to window so it can be called from index.js\r\n    window.fetchPlacesPG = fetchPlaces;\r\n\r\n    // REMOVED: Don't attach moveend listener here anymore\r\n    // The central handler in index.js will call fetchPlacesPG when needed\r\n\r\n    // Initial load only if layer is visible\r\n    if (window.map.hasLayer(window.placesLayerPG)) {\r\n        fetchPlaces();\r\n    }\r\n    \r\n    console.log(\"PG spots module initialized\");\r\n}\r\n\r\n// Listen for map initialization event\r\ndocument.addEventListener(\"map_initialized\", function() {\r\n    console.log(\"Map initialized event received in PG spots module\");\r\n    setTimeout(initSpotPG, 100);\r\n});\r\n\r\n// Alternative initialization approach\r\nsetTimeout(() => {\r\n    if (window.mapInitialized) {\r\n        console.log(\"Backup initialization for PG spots module\");\r\n        initSpotPG();\r\n    }\r\n}, 1000);","import { \r\n    getAngleRange, \r\n    loadPlaceDetails, \r\n    showFeebackForm, \r\n    cancelFeedback \r\n} from './spotsHelper.js';\r\n\r\n// Use a module initialization function that waits for map to be ready\r\nexport function initSpotHG() {\r\n    // Check if map and placesLayerHG are available in the window object\r\n    if (!window.map || !window.placesLayerHG) {\r\n        console.error(\"Map or placesLayerHG is not defined. Retrying in 500ms...\");\r\n        setTimeout(initSpotHG, 500);\r\n        return;\r\n    }\r\n\r\n    console.log(\"Initializing HG spots module...\");\r\n\r\n    // Expose needed functions to global scope for event handlers\r\n    window.showFeebackForm = showFeebackForm;\r\n    window.cancelFeedback = cancelFeedback;\r\n\r\n    // Create cluster group and nest it in the existing layer group\r\n    const clusterGroup = L.markerClusterGroup({\r\n        disableClusteringAtZoom: 9,\r\n        spiderfyOnMaxZoom: true,\r\n        showCoverageOnHover: true,\r\n        zoomToBoundsOnClick: true,\r\n        maxClusterRadius: 250,\r\n        iconCreateFunction: function(cluster) {\r\n            return L.divIcon({ \r\n                html: `<div class=\"cluster-marker\">${cluster.getChildCount()}</div>`,\r\n                className: 'hg-cluster-icon',\r\n                iconSize: L.point(30, 30)\r\n            });\r\n        }\r\n    });\r\n\r\n    window.placesLayerHG.addLayer(clusterGroup);\r\n\r\n    // Track current fetch controller to allow cancellation\r\n    let currentFetchController = null;\r\n    // Add debounce timer\r\n    let fetchDebounceTimer = null;\r\n    const DEBOUNCE_DELAY = 300; // ms\r\n\r\n    // Fetch places without descriptions\r\n    function fetchPlaces() {\r\n        // Clear any pending debounce\r\n        if (fetchDebounceTimer) {\r\n            clearTimeout(fetchDebounceTimer);\r\n        }\r\n        \r\n        // Debounce the fetch call to prevent rapid successive requests\r\n        fetchDebounceTimer = setTimeout(() => {\r\n            // Cancel any ongoing fetch\r\n            if (currentFetchController) {\r\n                currentFetchController.abort();\r\n            }\r\n\r\n            // Create a new controller for this fetch\r\n            currentFetchController = new AbortController();\r\n            const signal = currentFetchController.signal;\r\n\r\n            const bounds = window.map.getBounds();\r\n            const nw_lat = bounds.getNorthWest().lat;\r\n            const nw_lng = bounds.getNorthWest().lng;\r\n            const se_lat = bounds.getSouthEast().lat;\r\n            const se_lng = bounds.getSouthEast().lng;\r\n\r\n            fetch(`${process.env.APP_DOMAIN}/api/places?nw_lat=${nw_lat}&nw_lng=${nw_lng}&se_lat=${se_lat}&se_lng=${se_lng}&type=TO-HG&type=TOW-HG`, {\r\n                signal // Attach the abort signal to the fetch call\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    // Only process if this is still the active request\r\n                    if (signal.aborted) return;\r\n                    \r\n                    clusterGroup.clearLayers();\r\n\r\n                    L.geoJSON(data, {\r\n                        pointToLayer: function (feature, latlng) {\r\n                            return L.marker(latlng, {\r\n                                icon: L.canvasIcon({\r\n                                    iconSize: [50, 50],\r\n                                    iconAnchor: [15, 15],\r\n                                    drawIcon: function (icon, type) {\r\n                                        if (type === 'icon') {\r\n                                            var ctx = icon.getContext('2d');\r\n                                            var size = L.point(this.options.iconSize);\r\n                                            var center = L.point(size.x / 2, size.y / 2);\r\n                                            ctx.clearRect(0, 0, size.x, size.y);\r\n\r\n                                            let direction = feature.properties.direction || \"\";\r\n                                            let angleRanges = getAngleRange(direction);\r\n\r\n                                            ctx.beginPath();\r\n                                            angleRanges.forEach(([start, end]) => {\r\n                                                ctx.moveTo(center.x, center.y);\r\n                                                ctx.arc(center.x, center.y, center.x, (start - 90) * Math.PI / 180, (end - 90) * Math.PI / 180, false);\r\n                                                ctx.lineTo(center.x, center.y);\r\n                                            });\r\n                                            ctx.fillStyle = 'orange';\r\n                                            ctx.fill();\r\n                                            ctx.closePath();\r\n\r\n                                            ctx.beginPath();\r\n                                            ctx.arc(center.x, center.y, center.x / 4, 0, Math.PI * 2);\r\n                                            ctx.fillStyle = 'green';\r\n                                            ctx.fill();\r\n                                            ctx.closePath();\r\n                                        }\r\n                                    }\r\n                                })\r\n                            });\r\n                        },\r\n                        onEachFeature: function (feature, layer) {\r\n                            if (feature.properties) {\r\n                                let popupContent = `<b>${feature.properties.name}</b><br>\r\n                                                    Type: ${feature.properties.type}<br>\r\n                                                    Direction: ${feature.properties.direction}<br>\r\n                                                    <i>Loading details...</i>`;\r\n\r\n                                let responsivePopup = L.responsivePopup({\r\n                                    hasTip: true,\r\n                                    autoPan: false,\r\n                                    offset: [15, 25],\r\n                                    maxWidth: 900,\r\n                                    maxHeight: 780\r\n                                }).setContent(popupContent);\r\n\r\n                                layer.bindPopup(responsivePopup);\r\n\r\n                                layer.on(\"popupopen\", async function () {\r\n                                    await loadPlaceDetails(layer, feature.properties.id);\r\n                                });\r\n                            }\r\n                            \r\n                            clusterGroup.addLayer(layer);\r\n                        }\r\n                    });\r\n                    \r\n                    // Clear the controller reference when done\r\n                    currentFetchController = null;\r\n                })\r\n                .catch(error => {\r\n                    // Don't log aborted requests as errors\r\n                    if (error.name !== 'AbortError') {\r\n                        console.error(\"Error fetching HG places:\", error);\r\n                    }\r\n                });\r\n        }, DEBOUNCE_DELAY);\r\n    }\r\n\r\n    // IMPORTANT: Expose fetchPlaces to window so it can be called from index.js\r\n    window.fetchPlacesHG = fetchPlaces;\r\n\r\n    // REMOVED: Don't attach moveend listener here anymore\r\n    // The central handler in index.js will call fetchPlacesPG when needed\r\n\r\n    // Initial load only if layer is visible\r\n    if (window.map.hasLayer(window.placesLayerHG)) {\r\n        fetchPlaces();\r\n    }\r\n    \r\n    console.log(\"PG spots module initialized\");\r\n}\r\n\r\n// Listen for map initialization event\r\ndocument.addEventListener(\"map_initialized\", function() {\r\n    console.log(\"Map initialized event received in HG spots module\");\r\n    setTimeout(initSpotHG, 100);\r\n});\r\n\r\n// Alternative initialization approach\r\nsetTimeout(() => {\r\n    if (window.mapInitialized) {\r\n        console.log(\"Backup initialization for HG spots module\");\r\n        initSpotHG();\r\n    }\r\n}, 1000);","import { \r\n    getAngleRange, \r\n    loadPlaceDetails, \r\n    showFeebackForm, \r\n    cancelFeedback \r\n} from './spotsHelper.js';\r\n\r\n// Use a module initialization function that waits for map to be ready\r\nexport function initSpotLZ() {\r\n    if (!window.map || !window.placesLayerLZ) {\r\n        setTimeout(initSpotLZ, 500);\r\n        return;\r\n    }\r\n\r\n    console.log(\"Initializing LZ spots module...\");\r\n\r\n    // Create cluster group and nest it in the existing layer group\r\n    const clusterGroup = L.markerClusterGroup({\r\n        disableClusteringAtZoom: 9,\r\n        spiderfyOnMaxZoom: true,\r\n        showCoverageOnHover: true,\r\n        zoomToBoundsOnClick: true,\r\n        maxClusterRadius: 250,\r\n        iconCreateFunction: function(cluster) {\r\n            return L.divIcon({ \r\n                html: `<div class=\"cluster-marker\">${cluster.getChildCount()}</div>`,\r\n                className: 'lz-cluster-icon',\r\n                iconSize: L.point(30, 30)\r\n            });\r\n        }\r\n    });\r\n\r\n    window.placesLayerLZ.addLayer(clusterGroup); // Add cluster group to the layer group\r\n\r\n    // Track current fetch controller to allow cancellation\r\n    let currentFetchController = null;\r\n    // Add debounce timer\r\n    let fetchDebounceTimer = null;\r\n    const DEBOUNCE_DELAY = 300; // ms\r\n\r\n    // Update fetchPlaces to use clusterGroup\r\n    function fetchPlaces() {\r\n        // Clear any pending debounce\r\n        if (fetchDebounceTimer) {\r\n            clearTimeout(fetchDebounceTimer);\r\n        }\r\n        \r\n        // Debounce the fetch call to prevent rapid successive requests\r\n        fetchDebounceTimer = setTimeout(() => {\r\n            // Cancel any ongoing fetch\r\n            if (currentFetchController) {\r\n                currentFetchController.abort();\r\n            }\r\n\r\n            // Create a new controller for this fetch\r\n            currentFetchController = new AbortController();\r\n            const signal = currentFetchController.signal;\r\n            \r\n            const bounds = window.map.getBounds();\r\n            const nw_lat = bounds.getNorthWest().lat;\r\n            const nw_lng = bounds.getNorthWest().lng;\r\n            const se_lat = bounds.getSouthEast().lat;\r\n            const se_lng = bounds.getSouthEast().lng;\r\n\r\n            fetch(`${process.env.APP_DOMAIN}/api/places?nw_lat=${nw_lat}&nw_lng=${nw_lng}&se_lat=${se_lat}&se_lng=${se_lng}&type=LZ`, {\r\n                signal // Attach the abort signal to the fetch call\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    // Only process if this is still the active request\r\n                    if (signal.aborted) return;\r\n                    \r\n                    clusterGroup.clearLayers(); // Clear the cluster group\r\n\r\n                    L.geoJSON(data, {\r\n                        pointToLayer: function (feature, latlng) {\r\n                            return L.marker(latlng, {\r\n                                icon: L.icon({\r\n                                    iconUrl: '../assets/images/windsock.png', // Replace with the actual path to your PNG\r\n                                    iconSize: [20, 20], // Adjust size as needed\r\n                                    iconAnchor: [20, 20] // Adjust anchor to center the image properly\r\n                                })\r\n                            });\r\n                        },\r\n                        onEachFeature: function (feature, layer) {\r\n                            if (feature.properties) {\r\n                                let popupContent = `<b>${feature.properties.name}</b><br>\r\n                                                    Type: ${feature.properties.type}<br>\r\n                                                    Direction: ${feature.properties.direction}<br>\r\n                                                    <i>Loading details...</i>`;\r\n\r\n                                let responsivePopup = L.responsivePopup({\r\n                                    hasTip: true,\r\n                                    autoPan: false,\r\n                                    offset: [15, 25],\r\n                                    maxWidth: 900,\r\n                                    maxHeight: 780\r\n                                }).setContent(popupContent);\r\n\r\n                                layer.bindPopup(responsivePopup);\r\n\r\n                                // Fetch details when popup is opened\r\n                                layer.on(\"popupopen\", async function () {\r\n                                    await loadPlaceDetails(layer, feature.properties.id);\r\n                                });\r\n                               \r\n                            }\r\n                            \r\n                            clusterGroup.addLayer(layer); // Add to clusterGroup\r\n                        }\r\n                    });\r\n                    \r\n                    // Clear the controller reference when done\r\n                    currentFetchController = null;\r\n                })\r\n                .catch(error => {\r\n                    // Don't log aborted requests as errors\r\n                    if (error.name !== 'AbortError') {\r\n                        console.error(\"Error fetching LZ places:\", error);\r\n                    }\r\n                });\r\n        }, DEBOUNCE_DELAY);\r\n    }\r\n    // IMPORTANT: Expose fetchPlaces to window so it can be called from index.js\r\n    window.fetchPlacesLZ = fetchPlaces;\r\n\r\n    // REMOVED: Don't attach moveend listener here anymore\r\n    // The central handler in index.js will call fetchPlacesPG when needed\r\n\r\n    // Initial load only if layer is visible\r\n    if (window.map.hasLayer(window.placesLayerLZ)) {\r\n        fetchPlaces();\r\n    }\r\n    \r\n    console.log(\"PG spots module initialized\");\r\n}\r\n\r\n// Listen for map initialization event\r\ndocument.addEventListener(\"map_initialized\", function() {\r\n    console.log(\"Map initialized event received in LZ spots module\");\r\n    // Give a slight delay to ensure map is fully ready\r\n    setTimeout(initSpotLZ, 100);\r\n});\r\n\r\n// Alternative initialization approach - also try to init if we missed the event\r\nsetTimeout(() => {\r\n    if (window.mapInitialized) {\r\n        console.log(\"Backup initialization for LZ spots module\");\r\n        initSpotLZ();\r\n    }\r\n}, 1000);","\r\nimport './L.Control.Layers.Tree.js';\r\nimport '../css/L.Control.Layers.Tree.css';\r\nimport '../css/styles.css';\r\nimport InfoControl from './../../../components/InfoControl.js';\r\n\r\nimport './../../../components/airspaces.js';\r\nimport './../../../components/airspacesGliding.js';\r\nimport './../../../components/airspacesNotam.js';\r\nimport './../../../components/airspacesXC.js';\r\nimport './../../../components/windstations.js';\r\nimport './../../../components/spotsPG.js';\r\nimport './../../../components/spotsHG.js';\r\nimport './../../../components/spotsLZ.js';\r\n\r\n\r\n\r\n// Initialize map and make necessary objects globally available\r\nfunction initMap() {\r\n  // Create the map object and make it globally accessible\r\n  window.map = L.map('map', {\r\n      center: [50, 6],\r\n      zoom: 11,\r\n      zoomControl: false,\r\n      layers: [] \r\n  });\r\n  \r\n  L.control.zoom({\r\n      position: 'bottomright',\r\n  }).addTo(window.map);\r\n\r\n  // Base Layers\r\n  var awgTerrain = L.tileLayer('https://tile.jawg.io/jawg-terrain/{z}/{x}/{y}{r}.png?access-token=qBDXRu1KSlZGhx4ROlceBD9hcxmrumL34oj29tUkzDVkafqx08tFWPeRNb0KSoKa', {\r\n      attribution: 'Jawg.io terrain'\r\n  }).addTo(window.map);\r\n  \r\n  var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: ' OpenStreetMap'\r\n  });\r\n  \r\n  var xcontest = L.tileLayer('https://topo.xcontest.app/elev/{z}/{x}/{y}.jpg', {\r\n      attribution: 'XContest&copy; <a href=\"https://www.xcontest.org\">XContest</a>',\r\n      className: 'xcontest-layer'\r\n  });\r\n\r\n\r\n  // MapLibre GL layer\r\n  var mapTilerTerrain = L.mapboxGL({\r\n      style: '/assets/maps/maptiler_terrain_wob_testxc.json',\r\n      apiKey: \"c49iG8J3xvAkgCSZ8M8v\",\r\n      className: 'xcmap-layer',\r\n      attribution: 'MapTiler Terrain'\r\n  });\r\n  \r\n  var sat = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{\r\n      attribution: 'Map data: Google',\r\n      maxZoom: 20,\r\n      subdomains:['mt0','mt1','mt2','mt3']\r\n  });\r\n\r\n  var mbsat = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',{\r\n    attribution: ' Esri',\r\n    id: 'MapID',\r\n  });\r\n\r\n  var mapTilerTerrainOverlay = L.mapboxGL({\r\n    style: '/assets/maps/maptiler_terrain_wob_testxc.json',\r\n    apiKey: \"c49iG8J3xvAkgCSZ8M8v\",\r\n    className: 'xcmap-layer satellite-overlay',\r\n    attribution: 'MapTiler Terrain'\r\n});\r\n\r\n// Create a simplified contour overlay specifically for use with satellite\r\nvar contourOverlay = L.tileLayer('https://api.maptiler.com/tiles/contours/{z}/{x}/{y}.pbf?key=c49iG8J3xvAkgCSZ8M8v', {\r\n  attribution: 'MapTiler',\r\n  opacity: 0.8,\r\n  className: 'contour-overlay',\r\n  style: {\r\n      color: '#ffffff',\r\n      weight: 1,\r\n      opacity: 0.8\r\n  }\r\n});\r\n  // Layer groups - make them globally accessible\r\n  window.windLayer = L.layerGroup().addTo(window.map);\r\n  window.oaipMap = L.tileLayer(`https://a.api.tiles.openaip.net/api/data/openaip/{z}/{x}/{y}.png?apiKey=${process.env.OAIP_KEY}`, {\r\n      attribution: 'OpenAIP&copy; <a href=\"https://www.openaip.net\">OpenAIP</a>',\r\n      className: 'oaip-layer'\r\n  });\r\n  window.airspaceEFG = L.layerGroup([], {\r\n    attribution: 'OpenAIP&copy; <a href=\"https://www.openaip.net\">OpenAIP</a>',\r\n  });\r\n  window.airspaceGliding = L.layerGroup([], {\r\n    attribution: 'OpenAIP&copy; <a href=\"https://www.openaip.net\">OpenAIP</a>',\r\n  });\r\n  window.airspaceNotam = L.layerGroup([], {\r\n    attribution: 'OpenAIP&copy; <a href=\"https://www.openaip.net\">OpenAIP</a>',\r\n  });\r\n  window.airspaceXC = L.layerGroup([], {\r\n    attribution: 'Xcontest&copy; <a href=\"https://www.openaip.net\">OpenAIP</a>',\r\n  });\r\n  window.placesLayerPG = L.layerGroup( [], {\r\n    attribution: '&copy; <a href=\"https://paraglidingspots.com\">paraglidingspots.com</a>',\r\n  }); \r\n  window.placesLayerHG = L.layerGroup([], {\r\n    attribution: '&copy; <a href=\"https://paraglidingspots.com\">paraglidingspots.com</a>',\r\n  }); \r\n  window.placesLayerLZ = L.layerGroup([], {\r\n    attribution: '&copy; <a href=\"https://paraglidingspots.com\">paraglidingspots.com</a>',\r\n  });\r\n\r\n  function debugMapLayers() {\r\n    console.log(\"Current map layers:\");\r\n    window.map.eachLayer(function(layer) {\r\n        console.log(layer);\r\n    });\r\n  }\r\n\r\n\r\n  // Tree structure\r\n  var baseTree = {\r\n    label: 'Base Maps',\r\n    children: [\r\n        { label: 'Terrain', layer: awgTerrain },\r\n        { label: 'XContest', layer: L.layerGroup([xcontest, mapTilerTerrain])},\r\n        { label: 'OpenStreetMap', layer: osm },\r\n        { label: 'Satellite',  layer: sat },\r\n    ]\r\n};\r\n\r\n  var overlayTree = {\r\n      label: 'Overlays',\r\n      children: [\r\n          { label: 'Wind Stations', \r\n            children: [\r\n              { label: 'Wind Stations', layer: window.windLayer, checked: true  },\r\n          ]\r\n          },\r\n\r\n          { label: 'Spots',              \r\n              children: [\r\n                  { label: 'Take-off PG', layer: window.placesLayerPG },\r\n                  { label: 'Take-off HG', layer: window.placesLayerHG },\r\n                  { label: 'Landing Zones', layer: window.placesLayerLZ },\r\n              ]\r\n          },\r\n          { label: 'Airspaces', \r\n              children: [\r\n                      { \r\n                        html: `\r\n                            <div class=\"airspace-limit-control\">\r\n                                Active: \r\n                                <select class=\"lower-limit-select\" id=\"airspaceLowerLimit\">\r\n                                    <option value=\"Today\" selected>Today</option>\r\n                                    <option value=\"D+1\">D+1</option>\r\n                                    <option value=\"D+2\">D+1</option>\r\n                                    <option value=\"D+3\">D+1</option>\r\n                                    <option value=\"D+4\">D+1</option>\r\n                                    <option value=\"D+5\">D+5</option>\r\n                                    <option value=\"D+6\">D+6</option>\r\n                                    <option value=\"All\">All</option>\r\n                                </select>\r\n                            </div>\r\n                        `\r\n                    },\r\n                    { \r\n                      html: `\r\n                          <div class=\"airspace-limit-control\">\r\n                               below: \r\n                              <select class=\"lower-limit-select\" id=\"airspaceLowerLimit\">\r\n                                  <option value=\"2000\">2000m</option>\r\n                                  <option value=\"2500\">2500m</option>\r\n                                  <option value=\"3000\" selected>3000m</option>\r\n                                  <option value=\"3500\">3500m</option>\r\n                                  <option value=\"4000\">4000m</option>\r\n                                  <option value=\"4500\">4500m</option>\r\n                              </select>\r\n                          </div>\r\n                      `\r\n                  },\r\n                  { label: 'Airspaces', layer: window.airspaceEFG },\r\n                  { label: 'Gliding', layer: window.airspaceGliding },\r\n                  { label: 'Notam', layer: window.airspaceNotam },\r\n                  { label: 'XContest', layer: window.airspaceXC },\r\n                  { label: 'OpenAIP Map', layer: window.oaipMap},\r\n              ]\r\n          },\r\n      ]\r\n  };\r\n\r\n\r\n\r\n  new InfoControl({ position: 'bottomright' }).addTo(window.map);\r\n\r\n  // Add locate control\r\n  var lc = L.control\r\n      .locate({  \r\n          drawCircle: false, \r\n          keepCurrentZoomLevel: true,\r\n          position: 'bottomright',\r\n          icon: 'locate',\r\n          iconLoading: 'loading',\r\n          iconElementTag: 'div'\r\n      }).addTo(window.map);\r\n\r\n  // Add layer control tree\r\n  var treeLayersControl = L.control.layers.tree(baseTree, overlayTree, {\r\n      namedToggle: true,\r\n      collapsed: false\r\n  }).addTo(window.map);\r\n\r\n  treeLayersControl.collapseTree().expandSelected();\r\n  \r\n  // Central event handler for map movements\r\n  // This will be the ONLY moveend handler for fetching data\r\n  window.map.on('moveend', function() {\r\n    console.log('Map moveend event triggered');\r\n    \r\n    // Check if windLayer is on the map and fetchWindStations exists\r\n    if (window.map.hasLayer(window.windLayer) && typeof window.fetchWindStations === 'function') {\r\n      console.log('Fetching wind stations after map move...');\r\n      window.fetchWindStations();\r\n    }\r\n    \r\n    // Only trigger fetch for visible spot layers\r\n    if (window.map.hasLayer(window.placesLayerPG) && window.fetchPlacesPG) {\r\n      console.log('Fetching PG spots after map move...');\r\n      window.fetchPlacesPG();\r\n    }\r\n    \r\n    if (window.map.hasLayer(window.placesLayerHG) && window.fetchPlacesHG) {\r\n      console.log('Fetching HG spots after map move...');\r\n      window.fetchPlacesHG();\r\n    }\r\n    \r\n    if (window.map.hasLayer(window.placesLayerLZ) && window.fetchPlacesLZ) {\r\n      console.log('Fetching LZ spots after map move...');\r\n      window.fetchPlacesLZ();\r\n    }\r\n    \r\n    // Airspaces\r\n    if (window.map.hasLayer(window.airspaceEFG) && typeof window.fetchAirspaces === 'function') {\r\n      console.log('Fetching airspaces after map move...');\r\n      window.fetchAirspaces();\r\n    }\r\n    // Airspaces Gliding\r\n    if (window.map.hasLayer(window.airspaceGliding) && typeof window.fetchAirspacesGliding === 'function') {\r\n      console.log('Fetching airspaces after map move...');\r\n      window.fetchAirspacesGliding();\r\n    }\r\n    // Airspaces Notam\r\n    if (window.map.hasLayer(window.airspaceNotam) && typeof window.fetchAirspacesNotam === 'function') {\r\n      console.log('Fetching airspaces after map move...');\r\n      window.fetchAirspacesNotam();\r\n    }\r\n    // Airspaces XContest\r\n    if (window.map.hasLayer(window.airspaceXC) && typeof window.fetchAirspacesXC === 'function') {\r\n      console.log('Fetching airspaces after map move...');\r\n      window.fetchAirspacesXC();\r\n    }\r\n  });\r\n\r\ndocument.getElementById('airspaceLowerLimit').addEventListener('change', function(e) {\r\n    console.log('Selected limit:', e.target.value);\r\n});\r\n  \r\n  // Add layer change event listeners to fetch data when layers are added\r\n  window.map.on('layeradd', function(e) {\r\n    const layer = e.layer;\r\n    \r\n    // When a layer is added, fetch its data if needed\r\n    if (layer === window.windLayer && typeof window.fetchWindStations === 'function') {\r\n      window.fetchWindStations();\r\n    } else if (layer === window.placesLayerPG && window.fetchPlacesPG) {\r\n      window.fetchPlacesPG();\r\n    } else if (layer === window.placesLayerHG && window.fetchPlacesHG) {\r\n      window.fetchPlacesHG();\r\n    } else if (layer === window.placesLayerLZ && window.fetchPlacesLZ) {\r\n      window.fetchPlacesLZ();\r\n    } else if (layer === window.airspaceEFG && typeof window.fetchAirspaces === 'function') {\r\n      window.fetchAirspaces();\r\n    } else if (layer === window.airspaceGliding && typeof window.fetchAirspacesGliding === 'function') {\r\n      window.fetchAirspacesGliding();\r\n    } else if (layer === window.airspaceNotam && typeof window.fetchAirspacesNotam === 'function') {\r\n      window.fetchAirspacesNotam();\r\n    } else if (layer === window.airspaceXC && typeof window.fetchAirspacesXC === 'function') {\r\n      window.fetchAirspacesXC();\r\n    }\r\n  });\r\n  \r\n  // Signal that the map is fully initialized\r\n  window.mapInitialized = true;\r\n  console.log(\"Map initialization complete\");\r\n  \r\n  // Trigger an event that component scripts can listen for\r\n  const mapReadyEvent = new Event('map_initialized');\r\n  document.dispatchEvent(mapReadyEvent);\r\n  console.log(\"Map initialized event dispatched\");\r\n  \r\n  return window.map;\r\n}\r\n\r\n\r\n\r\n// Wait for DOM to be fully loaded\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  console.log(\"DOM content loaded, initializing map\");\r\n  // Initialize the map\r\n  const map = initMap();\r\n  \r\n  // Setup geolocation after map is initialized\r\n  navigator.geolocation.getCurrentPosition(position => {\r\n      console.log(\"Geolocation received\");\r\n      const userLat = position.coords.latitude;\r\n      const userLng = position.coords.longitude;\r\n      map.setView([userLat, userLng], 10);\r\n      \r\n      // Create a user location ready event\r\n      const locationReadyEvent = new CustomEvent('user_location_ready', {\r\n          detail: { lat: userLat, lng: userLng }\r\n      });\r\n      document.dispatchEvent(locationReadyEvent);\r\n      console.log(\"User location event dispatched\");\r\n  });\r\n\r\n  // Load component scripts after map is initialized\r\n  \r\n});\r\n\r\n// Special patch for initial data loading\r\ndocument.addEventListener('user_location_ready', function(e) {\r\n  console.log(\"Handling user location ready event\");\r\n  setTimeout(() => {\r\n      // Only call these functions if they exist, the map is fully initialized,\r\n      // AND their respective layers are visible\r\n      if (typeof window.fetchWindStations === 'function' && \r\n          window.mapInitialized && \r\n          window.map.hasLayer(window.windLayer)) {\r\n          try {\r\n              console.log(\"Fetching wind stations\");\r\n              window.fetchWindStations(e.detail.lat, e.detail.lng);\r\n          } catch (error) {\r\n              console.error('Error fetching wind stations:', error);\r\n          }\r\n      }\r\n      \r\n      if (typeof window.fetchAirspaces === 'function' && \r\n          window.mapInitialized && \r\n          window.map.hasLayer(window.airspaceEFG)) {\r\n          try {\r\n              console.log(\"Fetching airspaces\");\r\n              window.fetchAirspaces();\r\n          } catch (error) {\r\n              console.error('Error fetching airspaces:', error);\r\n          }\r\n      }\r\n\r\n      if (typeof window.fetchAirspacesGliding === 'function' && \r\n        window.mapInitialized && \r\n        window.map.hasLayer(window.airspaceGliding)) {\r\n        try {\r\n            console.log(\"Fetching airspaces\");\r\n            window.fetchAirspacesGliding();\r\n        } catch (error) {\r\n            console.error('Error fetching airspaces:', error);\r\n        }\r\n      }\r\n\r\n      if (typeof window.fetchAirspacesNotam === 'function' && \r\n        window.mapInitialized && \r\n        window.map.hasLayer(window.airspaceNotam)) {\r\n        try {\r\n            console.log(\"Fetching airspaces\");\r\n            window.fetchAirspacesNotam();\r\n        } catch (error) {\r\n            console.error('Error fetching airspaces:', error);\r\n        }\r\n      }\r\n\r\n      if (typeof window.fetchAirspacesXC === 'function' && \r\n        window.mapInitialized && \r\n        window.map.hasLayer(window.airspaceXC)) {\r\n        try {\r\n            console.log(\"Fetching airspaces\");\r\n            window.fetchAirspacesXC();\r\n        } catch (error) {\r\n            console.error('Error fetching airspaces:', error);\r\n        }\r\n      }\r\n  }, 500); // Give a short delay to ensure all scripts are loaded\r\n});","var map = {\n\t\"./af\": 5177,\n\t\"./af.js\": 5177,\n\t\"./ar\": 1509,\n\t\"./ar-dz\": 1488,\n\t\"./ar-dz.js\": 1488,\n\t\"./ar-kw\": 8676,\n\t\"./ar-kw.js\": 8676,\n\t\"./ar-ly\": 2353,\n\t\"./ar-ly.js\": 2353,\n\t\"./ar-ma\": 4496,\n\t\"./ar-ma.js\": 4496,\n\t\"./ar-ps\": 6947,\n\t\"./ar-ps.js\": 6947,\n\t\"./ar-sa\": 2682,\n\t\"./ar-sa.js\": 2682,\n\t\"./ar-tn\": 9756,\n\t\"./ar-tn.js\": 9756,\n\t\"./ar.js\": 1509,\n\t\"./az\": 5533,\n\t\"./az.js\": 5533,\n\t\"./be\": 8959,\n\t\"./be.js\": 8959,\n\t\"./bg\": 7777,\n\t\"./bg.js\": 7777,\n\t\"./bm\": 4903,\n\t\"./bm.js\": 4903,\n\t\"./bn\": 1290,\n\t\"./bn-bd\": 7357,\n\t\"./bn-bd.js\": 7357,\n\t\"./bn.js\": 1290,\n\t\"./bo\": 1545,\n\t\"./bo.js\": 1545,\n\t\"./br\": 1470,\n\t\"./br.js\": 1470,\n\t\"./bs\": 4429,\n\t\"./bs.js\": 4429,\n\t\"./ca\": 7306,\n\t\"./ca.js\": 7306,\n\t\"./cs\": 6464,\n\t\"./cs.js\": 6464,\n\t\"./cv\": 3635,\n\t\"./cv.js\": 3635,\n\t\"./cy\": 4226,\n\t\"./cy.js\": 4226,\n\t\"./da\": 3601,\n\t\"./da.js\": 3601,\n\t\"./de\": 7853,\n\t\"./de-at\": 6111,\n\t\"./de-at.js\": 6111,\n\t\"./de-ch\": 4697,\n\t\"./de-ch.js\": 4697,\n\t\"./de.js\": 7853,\n\t\"./dv\": 708,\n\t\"./dv.js\": 708,\n\t\"./el\": 4691,\n\t\"./el.js\": 4691,\n\t\"./en-au\": 3872,\n\t\"./en-au.js\": 3872,\n\t\"./en-ca\": 8298,\n\t\"./en-ca.js\": 8298,\n\t\"./en-gb\": 6195,\n\t\"./en-gb.js\": 6195,\n\t\"./en-ie\": 6584,\n\t\"./en-ie.js\": 6584,\n\t\"./en-il\": 5543,\n\t\"./en-il.js\": 5543,\n\t\"./en-in\": 9033,\n\t\"./en-in.js\": 9033,\n\t\"./en-nz\": 9402,\n\t\"./en-nz.js\": 9402,\n\t\"./en-sg\": 3004,\n\t\"./en-sg.js\": 3004,\n\t\"./eo\": 2934,\n\t\"./eo.js\": 2934,\n\t\"./es\": 7650,\n\t\"./es-do\": 838,\n\t\"./es-do.js\": 838,\n\t\"./es-mx\": 7730,\n\t\"./es-mx.js\": 7730,\n\t\"./es-us\": 6575,\n\t\"./es-us.js\": 6575,\n\t\"./es.js\": 7650,\n\t\"./et\": 3035,\n\t\"./et.js\": 3035,\n\t\"./eu\": 3508,\n\t\"./eu.js\": 3508,\n\t\"./fa\": 119,\n\t\"./fa.js\": 119,\n\t\"./fi\": 527,\n\t\"./fi.js\": 527,\n\t\"./fil\": 5995,\n\t\"./fil.js\": 5995,\n\t\"./fo\": 2477,\n\t\"./fo.js\": 2477,\n\t\"./fr\": 5498,\n\t\"./fr-ca\": 6435,\n\t\"./fr-ca.js\": 6435,\n\t\"./fr-ch\": 7892,\n\t\"./fr-ch.js\": 7892,\n\t\"./fr.js\": 5498,\n\t\"./fy\": 7071,\n\t\"./fy.js\": 7071,\n\t\"./ga\": 1734,\n\t\"./ga.js\": 1734,\n\t\"./gd\": 217,\n\t\"./gd.js\": 217,\n\t\"./gl\": 7329,\n\t\"./gl.js\": 7329,\n\t\"./gom-deva\": 2124,\n\t\"./gom-deva.js\": 2124,\n\t\"./gom-latn\": 3383,\n\t\"./gom-latn.js\": 3383,\n\t\"./gu\": 5050,\n\t\"./gu.js\": 5050,\n\t\"./he\": 1713,\n\t\"./he.js\": 1713,\n\t\"./hi\": 3861,\n\t\"./hi.js\": 3861,\n\t\"./hr\": 6308,\n\t\"./hr.js\": 6308,\n\t\"./hu\": 609,\n\t\"./hu.js\": 609,\n\t\"./hy-am\": 7160,\n\t\"./hy-am.js\": 7160,\n\t\"./id\": 4063,\n\t\"./id.js\": 4063,\n\t\"./is\": 9374,\n\t\"./is.js\": 9374,\n\t\"./it\": 8383,\n\t\"./it-ch\": 1827,\n\t\"./it-ch.js\": 1827,\n\t\"./it.js\": 8383,\n\t\"./ja\": 3827,\n\t\"./ja.js\": 3827,\n\t\"./jv\": 9722,\n\t\"./jv.js\": 9722,\n\t\"./ka\": 1794,\n\t\"./ka.js\": 1794,\n\t\"./kk\": 7088,\n\t\"./kk.js\": 7088,\n\t\"./km\": 6870,\n\t\"./km.js\": 6870,\n\t\"./kn\": 4451,\n\t\"./kn.js\": 4451,\n\t\"./ko\": 3164,\n\t\"./ko.js\": 3164,\n\t\"./ku\": 8174,\n\t\"./ku-kmr\": 6181,\n\t\"./ku-kmr.js\": 6181,\n\t\"./ku.js\": 8174,\n\t\"./ky\": 8474,\n\t\"./ky.js\": 8474,\n\t\"./lb\": 9680,\n\t\"./lb.js\": 9680,\n\t\"./lo\": 5867,\n\t\"./lo.js\": 5867,\n\t\"./lt\": 5766,\n\t\"./lt.js\": 5766,\n\t\"./lv\": 9532,\n\t\"./lv.js\": 9532,\n\t\"./me\": 8076,\n\t\"./me.js\": 8076,\n\t\"./mi\": 1848,\n\t\"./mi.js\": 1848,\n\t\"./mk\": 306,\n\t\"./mk.js\": 306,\n\t\"./ml\": 3739,\n\t\"./ml.js\": 3739,\n\t\"./mn\": 9053,\n\t\"./mn.js\": 9053,\n\t\"./mr\": 6169,\n\t\"./mr.js\": 6169,\n\t\"./ms\": 3386,\n\t\"./ms-my\": 2297,\n\t\"./ms-my.js\": 2297,\n\t\"./ms.js\": 3386,\n\t\"./mt\": 7075,\n\t\"./mt.js\": 7075,\n\t\"./my\": 2264,\n\t\"./my.js\": 2264,\n\t\"./nb\": 2274,\n\t\"./nb.js\": 2274,\n\t\"./ne\": 8235,\n\t\"./ne.js\": 8235,\n\t\"./nl\": 2572,\n\t\"./nl-be\": 3784,\n\t\"./nl-be.js\": 3784,\n\t\"./nl.js\": 2572,\n\t\"./nn\": 4566,\n\t\"./nn.js\": 4566,\n\t\"./oc-lnc\": 9330,\n\t\"./oc-lnc.js\": 9330,\n\t\"./pa-in\": 9849,\n\t\"./pa-in.js\": 9849,\n\t\"./pl\": 4418,\n\t\"./pl.js\": 4418,\n\t\"./pt\": 9834,\n\t\"./pt-br\": 8303,\n\t\"./pt-br.js\": 8303,\n\t\"./pt.js\": 9834,\n\t\"./ro\": 4457,\n\t\"./ro.js\": 4457,\n\t\"./ru\": 2271,\n\t\"./ru.js\": 2271,\n\t\"./sd\": 1221,\n\t\"./sd.js\": 1221,\n\t\"./se\": 3478,\n\t\"./se.js\": 3478,\n\t\"./si\": 7538,\n\t\"./si.js\": 7538,\n\t\"./sk\": 5784,\n\t\"./sk.js\": 5784,\n\t\"./sl\": 6637,\n\t\"./sl.js\": 6637,\n\t\"./sq\": 6794,\n\t\"./sq.js\": 6794,\n\t\"./sr\": 5719,\n\t\"./sr-cyrl\": 3322,\n\t\"./sr-cyrl.js\": 3322,\n\t\"./sr.js\": 5719,\n\t\"./ss\": 6000,\n\t\"./ss.js\": 6000,\n\t\"./sv\": 1011,\n\t\"./sv.js\": 1011,\n\t\"./sw\": 748,\n\t\"./sw.js\": 748,\n\t\"./ta\": 1025,\n\t\"./ta.js\": 1025,\n\t\"./te\": 1885,\n\t\"./te.js\": 1885,\n\t\"./tet\": 8861,\n\t\"./tet.js\": 8861,\n\t\"./tg\": 6571,\n\t\"./tg.js\": 6571,\n\t\"./th\": 5802,\n\t\"./th.js\": 5802,\n\t\"./tk\": 9527,\n\t\"./tk.js\": 9527,\n\t\"./tl-ph\": 9231,\n\t\"./tl-ph.js\": 9231,\n\t\"./tlh\": 1052,\n\t\"./tlh.js\": 1052,\n\t\"./tr\": 5096,\n\t\"./tr.js\": 5096,\n\t\"./tzl\": 9846,\n\t\"./tzl.js\": 9846,\n\t\"./tzm\": 1765,\n\t\"./tzm-latn\": 7711,\n\t\"./tzm-latn.js\": 7711,\n\t\"./tzm.js\": 1765,\n\t\"./ug-cn\": 8414,\n\t\"./ug-cn.js\": 8414,\n\t\"./uk\": 6618,\n\t\"./uk.js\": 6618,\n\t\"./ur\": 158,\n\t\"./ur.js\": 158,\n\t\"./uz\": 7609,\n\t\"./uz-latn\": 2475,\n\t\"./uz-latn.js\": 2475,\n\t\"./uz.js\": 7609,\n\t\"./vi\": 1135,\n\t\"./vi.js\": 1135,\n\t\"./x-pseudo\": 4051,\n\t\"./x-pseudo.js\": 4051,\n\t\"./yo\": 2218,\n\t\"./yo.js\": 2218,\n\t\"./zh-cn\": 2648,\n\t\"./zh-cn.js\": 2648,\n\t\"./zh-hk\": 1632,\n\t\"./zh-hk.js\": 1632,\n\t\"./zh-mo\": 1541,\n\t\"./zh-mo.js\": 1541,\n\t\"./zh-tw\": 304,\n\t\"./zh-tw.js\": 304\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 5358;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkwind_station_app\"] = self[\"webpackChunkwind_station_app\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [96], () => (__webpack_require__(2854)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","console","log","L","Error","Control","Layers","Tree","extend","options","closedSymbol","openedSymbol","spaceSymbol","selectorBack","namedToggle","collapseAll","expandAll","labelIsSelector","_initClassesNames","this","cls","children","childrenNopad","hide","closed","opened","space","pointer","header","neverShow","node","name","label","selAllCheckbox","initialize","baseTree","overlaysTree","_scrollTop","_baseTree","_overlaysTree","Util","setOptions","prototype","call","_setTrees","setBaseTree","tree","setOverlayTree","undefined","addBaseLayer","_layer","_name","addOverlay","removeLayer","collapse","_sect","scrollTop","expand","onAdd","map","changeName","layer","_layersTreeName","toggle","innerHTML","ret","_container","getElementsByClassName","DomUtil","addClass","eachLayer","on","e","expandTree","overlay","container","_overlaysList","_baseLayersList","_applyOnTree","_localExpand","collapseTree","expandSelected","iter","el","p","parentElement","hasClass","that","removeClass","h","inputs","_layerControlInputs","getElementsByTagName","i","length","input","_getLayer","layerId","checked","_section","_form","base","overlays","id","iterate","output","forEach","child","forArrays","Array","isArray","noShow","_layers","off","_onLayerChange","bflat","j","_addLayer","oflat","k","_map","_update","top","it","els","_addItem","_obj","_addTreeLayout","_expandCollapseAll","_iterateTreeLayout","_checkDisabledLayers","text","fn","ctx","o","document","createElement","className","appendChild","tabIndex","DomEvent","type","keyCode","blur","selAllNodes","html","creator","selAll","sel","entry","insertBefore","selectAllCheckbox","_createCheckboxElement","sensible","_preventClick","splice","variable","hasLayer","radioGroup","stamp","_createRadioElement","manageSelectorsAll","push","_onInputClick","String","title","ev","stopPropagation","selectAllCheckboxes","updateSelAllCheckbox","collapsed","eventeds","eventedClasses","evented","obj","querySelector","event","selectAll","functionToCheck","select","toString","append","create","ancestor","selector","selectedAll","selectedNone","querySelectorAll","inp","indeterminate","_ev","defaultChecked","control","layers","window","link","href","img","src","alt","style","width","height","padding","disableClickPropagation","stop","popup","autoPan","setLatLng","getCenter","setContent","openOn","airspaceDebounceTimer","airspaceClickHandler","currentLowerLimit","fetchAirspaces","error","center","apiUrl","lat","toFixed","lng","encodeURIComponent","join","fetch","then","response","json","data","airspaceEFG","clearLayers","airspaces","items","airspace","icaoClass","selectedLimit","parseInt","getElementById","value","lowerLimit","lowerLimitMeters","unitCode","convertToMeters","unit","geometry","coordinates","coord","color","polygon","airspaceTypes","icaoClasses","weight","fillOpacity","addLayer","clickedPoint","latlng","overlappingAirspaces","_ref","getBounds","contains","popupContent","a","_id","getUnit","upperLimit","catch","addEventListener","body","target","newLimit","clearTimeout","setTimeout","fetchAirspacesGliding","airspaceGliding","fetchAirspacesNotam","airspaceNotam","getCompassDirection","deg","Math","round","getFillColor","speed","getStrokeColor","getTextColor","backgroundColor","fetchAirspacesXC","bounds","nw","getNorthWest","se","getSouthEast","today","Date","getFullYear","getMonth","padStart","getDate","airspaceXC","features","currentDate","intl","Intl","DateTimeFormat","resolvedOptions","timeZone","tzShort","moment","tz","zoneAbbr","feature","properties","startsWith","descriptions","isExpired","desc","cMatch","airdescription","match","dateStr","year","substring","month","day","hour","minute","expirationDate","lowerLimitInfo","airlower_j","strokeColor","strokeWeight","fillColor","tzName","guess","timezoneInfo","format","descriptionsHtml","formatDescription","replace","airlanguage","activationsHtml","activations","activation","startDate","endDate","formatDate","date","toLocaleString","hour12","airspaceClass","showTab","tabId","element","tab","display","classList","remove","targetTab","add","stationId","split","canvas","chartInstance","resize","update","warn","fetchWindStations","nwLat","nwLng","seLat","seLng","responseData","windLayer","station","lon","loc","windDirection","last","windAvg","windMax","compassDirection","lastUpdate","toLocaleTimeString","peakArrow","peak","isHolfuy","includes","holfuyStationId","arrowSvg","arrowIcon","divIcon","iconSize","iconAnchor","marker","icon","addTo","historyData","aggregatedData","grouped","dt","setMinutes","floor","getMinutes","setSeconds","setMilliseconds","key","getTime","count","wAvgSum","wMaxSum","wDirSum","tempSum","tempCount","result","Object","keys","sort","b","processHistoricalData","fiveHoursAgo","now","limitedData","filter","historyTable","timeFormatted","compassDir","chartData","slice","reverse","popupHtml","short","bindPopup","responsivePopup","hasTip","offset","maxWidth","maxHeight","getContext","chartDataPointsAvg","x","y","chartDataPointsMax","Chart","datasets","borderColor","fill","pointRadius","responsive","maintainAspectRatio","layout","bottom","scales","time","displayFormats","tooltipFormat","grid","drawBorder","ticks","autoSkip","maxRotation","minRotation","beginAtZero","stepSize","maxTicksLimit","font","size","plugins","legend","afterDraw","chart","xAxis","save","arrowRowY","textAlign","textBaseline","getPixelForValue","translate","rotate","PI","fillText","restore","cameraImageUrl","cameraImageElement","cameraTabElement","testImage","Image","onload","onerror","complete","naturalWidth","feedbackDropzone","currentFeedbackForm","changeSwiper","swiperc","innerWidth","$","css","changeDirection","getAngleRange","direction","dirToAngle","angleRanges","part","trim","range","dir","angle","start","end","async","loadPlaceDetails","placeId","regex1","regex2","regexHeight","regexHD","regexRating","description","currentPlaceName","currentPlaceId","currentStrPlacemarkId","strPlacemarkId","rating","heightdifference","lastupdate","setPopupContent","firstImg","idImg","swiperv","swiperLoop3","swiperLoop4","Swiper","autoHeight","allowTouchMove","mousewheel","slidesPerView","loop","spaceBetween","breakpoints","scrollbar","draggable","click","iR","clickedSlide","firstChild","slideTo","transitionEnd","realIndex","initSwiper","closePopup","showFeebackForm","destroy","messageDiv","textContent","modalFooter","feedbackFormHtml","insertAdjacentHTML","popupContainer","scrollTo","scrollHeight","behavior","Dropzone","url","autoProcessQueue","maxFiles","maxFilesize","acceptedFiles","addRemoveLinks","dictDefaultMessage","clickable","init","dzInstance","file","previewElement","deleteIcon","preventDefault","removeFile","isValid","test","formData","FormData","files","method","success","message","cancelFeedback","initSpotPG","placesLayerPG","clusterGroup","markerClusterGroup","disableClusteringAtZoom","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","iconCreateFunction","cluster","getChildCount","point","currentFetchController","fetchDebounceTimer","fetchPlaces","abort","AbortController","signal","nw_lat","nw_lng","se_lat","se_lng","aborted","geoJSON","pointToLayer","canvasIcon","drawIcon","clearRect","beginPath","moveTo","arc","lineTo","fillStyle","closePath","onEachFeature","fetchPlacesPG","initSpotHG","placesLayerHG","fetchPlacesHG","initSpotLZ","placesLayerLZ","iconUrl","fetchPlacesLZ","mapInitialized","zoom","zoomControl","position","awgTerrain","tileLayer","attribution","osm","xcontest","mapTilerTerrain","mapboxGL","apiKey","sat","maxZoom","subdomains","opacity","layerGroup","oaipMap","overlayTree","InfoControl","locate","drawCircle","keepCurrentZoomLevel","iconLoading","iconElementTag","mapReadyEvent","Event","dispatchEvent","initMap","navigator","geolocation","getCurrentPosition","userLat","coords","latitude","userLng","longitude","setView","locationReadyEvent","CustomEvent","detail","webpackContext","req","webpackContextResolve","__webpack_require__","code","resolve","module","exports","__webpack_module_cache__","moduleId","cachedModule","loaded","__webpack_modules__","m","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","every","r","prop","hasOwnProperty","nmd","paths","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}